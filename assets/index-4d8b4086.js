import{_ as E,r as p,g as m,B as R,c as a,w as z,e as l,a as s,j as y,b as n,d as f,F as L,o as r,m as B,p as O,f as S,L as V}from"./index-fb965be0.js";const x=d=>(O("data-v-2907bfa4"),d=d(),S(),d),A=x(()=>s("div",{class:"title"},"Lodop 打印",-1)),F={key:0},H={key:0,class:"download-lodop"},M=x(()=>s("a",{href:"CLodop.protocol:setup"},"点这里直接再次启动",-1)),j={class:"print-content"},q="http://www.c-lodop.com/download/CLodop_Setup_for_Win64NT_6.577EN.zip",k="http://localhost:8000/CLodopFuncs.js",G={__name:"index",setup(d){const i=p(!1),_=p(!1),u=p(!1);let e=null;const C=()=>{i.value=!0,document.querySelectorAll("script").forEach(t=>{t.src===k&&document.body.removeChild(t)});const o=document.createElement("script");o.src=k,o.onerror=()=>{console.log("Lodop 加载失败"),_.value=!0,u.value=!1,i.value=!1},o.onload=()=>{u.value=!0,_.value=!1,e=window.LODOP,i.value=!1},document.body.appendChild(o)};(()=>{window.LODOP||C()})();const I=[{prop:"date",label:"日期",minWidth:100},{prop:"name",label:"名字",minWidth:100},{prop:"province",label:"省份",minWidth:100},{prop:"city",label:"城市",minWidth:100},{prop:"address",label:"地址",minWidth:150},{prop:"zip",label:"邮编",minWidth:100},{prop:"remark",label:"备注",minWidth:150}],T=[{date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000",remark:""},{date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000",remark:""},{date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000",remark:""},{date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000",remark:""}],b=p(),v=()=>window.LODOP?!0:(V.alert("Web打印服务CLodop未安装或启动，请先安装或启动","",{confirmButtonText:"确认",type:"error",callback:()=>{}}),!1),h=()=>{e.PRINT_INIT("tablePrint"),e.ADD_PRINT_HTM(10,55,"100%","100%",b.value.innerHTML)},W=()=>{v()&&(h(),e.PREVIEW())},N=()=>{v()&&(h(),e.PRINT())};return(P,o)=>{const t=m("el-button"),w=m("el-table-column"),g=m("el-table"),D=R("loading");return r(),a(L,null,[A,z((r(),a("div",null,[_.value?(r(),a("div",F,[u.value?y("",!0):(r(),a("div",H,[l(" Web打印服务CLodop未安装启动，点击这里 "),s("a",{href:q},"下载"),l(" ，并且执行安装（若此前已安装过，可 "),M,l(" ），成功后请刷新本页面或重启浏览器。 ")]))])):y("",!0),n(t,{type:"primary",onClick:W},{default:f(()=>[l("打印预览")]),_:1}),n(t,{type:"primary",onClick:N},{default:f(()=>[l("直接打印")]),_:1}),s("div",j,[s("div",{ref_key:"printTableRef",ref:b},[n(g,{ref:"tableRef",data:T,border:"",stripe:"","max-height":400},{default:f(()=>[n(w,{type:"index",fixed:"left",label:"序号",width:"70"}),(r(),a(L,null,B(I,c=>n(w,{key:c.prop,prop:c.prop,label:c.label,"min-width":c.minWidth},null,8,["prop","label","min-width"])),64))]),_:1},512)],512)])])),[[D,i.value]])],64)}}},Q=E(G,[["__scopeId","data-v-2907bfa4"]]);export{Q as default};
