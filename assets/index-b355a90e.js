import{_ as C,r as H,n as q,o as Z,w as ee,a as B,c as L,b as T,F as G,d as te,e as S,u as $,f as le,g as J,h as V,i as o,j as h,k as K,t as O,p as ie,l as ae}from"./index-441f84fa.js";const oe={__name:"virtual-list",props:{data:{type:Array,default:()=>[]},height:{type:Number,default:void 0},maxHeight:{type:Number,default:void 0},itemHeight:{type:Number,default:10},minItemHeight:{type:Number,default:10},buffer:{type:Number,default:10},fixed:{type:Boolean,default:!0}},setup(x){const e=x,d=e.fixed;let c=[],a=0,m=0,p=e.itemHeight?e.itemHeight:10,b=e.minItemHeight?e.minItemHeight:10,u=0,v=0;const s=Math.ceil(v/4),t=H([]);let i=0,l=0,f=0;const N=H(0),n=H(0);let w=0;const R=H(null),U=H(null);let I=[],F=!1;Q();function Q(){e.height&&e.maxHeight?m=Math.min(e.height,e.maxHeight):e.height?m=e.height:e.maxHeight&&(m=e.maxHeight),j()}function j(){if(R.value&&(R.value.scrollTop=0),c=e.data.map((g,r)=>({id:`${new Date().getTime()}-${r}`,data:g})),a=c.length,p=e.itemHeight?e.itemHeight:10,b=e.minItemHeight?e.minItemHeight:10,!m){t.value=c;return}d?u=Math.ceil(m/p):u=Math.ceil(m/b),u>a&&(u=a),v=e.buffer>=10?e.buffer:10,u+v>a&&(v=a-u),i=u+v,l=0,f=i-1,N.value=0,d?n.value=(a-i)*p:n.value=(a-i)*b,t.value=c.slice(l,f+1),w=0,d||q(()=>{I=z()})}function z(){const g=U.value.children,r=[];for(let _=0;_<g.length;_++)r.push(g[_].getBoundingClientRect().height);for(let _=r.length;_<c.length;_++)r.push(b);return r}Z(()=>{if(d||!m||i>=a)return;I=z();let g=0;for(let r=0;r<I.length;r++){if(g+=I[r],m===g){u=r+1;break}if(m<g){u=r+1;break}}u===0&&(u=a),u+v>a&&(v=a-u),i=u+v,f=i-1,t.value=c.slice(l,f+1),n.value=(a-i)*b}),ee(()=>e.data,()=>{j()});function X(g){const r=g.target.scrollTop;let _=0;if(d)_=Math.floor(r/p);else{let k=0;for(let M=0;M<I.length;M++){if(k+=I[M],r===k){_=M+1;break}if(r<k){_=M;break}}}if(r>w){if(w=r,f+1-_-u>s)return}else if(r<w){if(w=r,_-l>s)return}else return;l=_-Math.floor(v/2);const A=a-i;l<0?l=0:l>A&&(l=A),f=l+i-1;const E=a-1;if(f>E&&(f=E),t.value=c.slice(l,f+1),d)N.value=l*p,n.value=(a-f-1)*p;else{let k=0;for(let y=0;y<l;y++)k+=I[y];N.value=k;let M=0;for(let y=f+1;y<a;y++)M+=I[y];n.value=M,q(()=>{const y=U.value.children,W=[];for(let D=0;D<y.length;D++)W.push(y[D].getBoundingClientRect().height);I.splice(l,W.length,...W)})}}function Y(g){!m||i>=a||F||(F=!0,requestAnimationFrame(()=>{F=!1}),X(g))}return(g,r)=>(B(),L("div",{ref_key:"listWrapRef",ref:R,class:"list-wrap",style:S({height:x.height?x.height+"px":"","max-height":x.maxHeight?x.maxHeight+"px":""}),onScroll:Y},[T("ul",{ref_key:"listRef",ref:U,style:S({"padding-top":N.value+"px","padding-bottom":n.value+"px"})},[(B(!0),L(G,null,te(t.value,_=>(B(),L("li",{key:_.id,class:"list-item",style:S({height:$(d)?$(p)+"px":"","word-break":$(d)?"normal":"break-all",overflow:$(d)?"hidden":"visible"})},[le(g.$slots,"default",{item:_.data},void 0,!0)],4))),128))],4)],36))}},P=C(oe,[["__scopeId","data-v-680045ae"]]);const ne={class:"wrap"},ue={__name:"fixed-virtual-list",setup(x){const e=J({total:1e3,itemHeight:30,buffer:20}),d=H([]),c=H(e.itemHeight),a=H(e.buffer);let m=e.total,p=e.itemHeight,b=e.buffer;u();function u(){let s=Number(e.total);s||(e.total=m,s=m),m=s,d.value=[];for(let l=1;l<=s;l++)d.value.push({msg:`${v()} --- ${l}`});let t=Number(e.itemHeight);t||(e.itemHeight=p,t=p),p=t,c.value=t;let i=Number(e.buffer);i||(e.buffer=b,i=b),b=i,a.value=i}function v(){let s="";const t=["a","b","c","d","e","f","g","h","i","j","k"];for(let i=0;i<t.length;i++){const l=Math.ceil(Math.random()*10);s+=t[l]}return s}return(s,t)=>{const i=V("el-input"),l=V("el-form-item"),f=V("el-button"),N=V("el-form");return B(),L("div",null,[o(N,{inline:""},{default:h(()=>[o(l,{label:"列表总数"},{default:h(()=>[o(i,{modelValue:e.total,"onUpdate:modelValue":t[0]||(t[0]=n=>e.total=n),modelModifiers:{number:!0},placeholder:"请输入列表总数"},null,8,["modelValue"])]),_:1}),o(l,{label:"行高"},{default:h(()=>[o(i,{modelValue:e.itemHeight,"onUpdate:modelValue":t[1]||(t[1]=n=>e.itemHeight=n),placeholder:"请输入每一行的高度"},null,8,["modelValue"])]),_:1}),o(l,{label:"缓冲量"},{default:h(()=>[o(i,{modelValue:e.buffer,"onUpdate:modelValue":t[2]||(t[2]=n=>e.buffer=n),placeholder:"请输入缓冲区域加载的列表数量"},null,8,["modelValue"])]),_:1}),o(l,null,{default:h(()=>[o(f,{type:"primary",onClick:u},{default:h(()=>[K("更新列表")]),_:1})]),_:1})]),_:1}),T("div",ne,[o(P,{data:d.value,"max-height":300,"item-height":c.value,buffer:a.value},{default:h(({item:n})=>[T("div",{class:"list-item",style:S({"line-height":c.value-1+"px"})},O(n.msg),5)]),_:1},8,["data","item-height","buffer"])])])}}},re=C(ue,[["__scopeId","data-v-ac6cd748"]]);const se={class:"wrap"},fe={class:"list-item"},de={__name:"dynamic-virtual-list",setup(x){const e=J({total:1e3,minItemHeight:30,buffer:20}),d=H([]),c=H(e.minItemHeight),a=H(e.buffer);let m=e.total,p=e.minItemHeight,b=e.buffer;u();function u(){let s=Number(e.total);s||(e.total=m,s=m),m=s,d.value=[];let t=0;for(let f=1;f<=s;f++)t=Math.ceil(Math.random()*200),t=t<30?30:t,d.value.push({msg:`${v()} --- ${f}`});Number(e.minItemHeight)||(e.minHeight=p,t=p),p=t,c.value=t;let l=Number(e.buffer);l||(e.buffer=b,l=b),b=l,a.value=l}function v(){const s=["道可道也，非恒道也。","名可名也，非恒名也。","无名万物之始也，有名万物之母也。","故：恒无欲也，以观其眇；","恒有欲也，以观其徼。","两者同出，异名同谓。玄之又玄，众妙之门。","天下皆知美之为美，恶矣，皆知善之为善，斯不善矣。","有无之相生也，难易之相成也，长短之相形也，高下之相盈也，音声之相和也，先后之相随也。","是以圣人居无为之事，行不言之教。","万物作而弗始也，为而弗恃也，成功而弗居也，夫唯弗居，是以弗去。"],t=Math.ceil(Math.random()*10);return s.slice(0,t)}return(s,t)=>{const i=V("el-input"),l=V("el-form-item"),f=V("el-button"),N=V("el-form");return B(),L("div",null,[o(N,{inline:""},{default:h(()=>[o(l,{label:"列表总数"},{default:h(()=>[o(i,{modelValue:e.total,"onUpdate:modelValue":t[0]||(t[0]=n=>e.total=n),modelModifiers:{number:!0},placeholder:"请输入列表总数"},null,8,["modelValue"])]),_:1}),o(l,{label:"最小行高"},{default:h(()=>[o(i,{modelValue:e.minItemHeight,"onUpdate:modelValue":t[1]||(t[1]=n=>e.minItemHeight=n),placeholder:"请输入行高的最小值"},null,8,["modelValue"])]),_:1}),o(l,{label:"缓冲量"},{default:h(()=>[o(i,{modelValue:e.buffer,"onUpdate:modelValue":t[2]||(t[2]=n=>e.buffer=n),placeholder:"请输入缓冲区域加载的列表数量"},null,8,["modelValue"])]),_:1}),o(l,null,{default:h(()=>[o(f,{type:"primary",onClick:u},{default:h(()=>[K("更新列表")]),_:1})]),_:1})]),_:1}),T("div",se,[o(P,{data:d.value,"max-height":300,"min-item-height":c.value,buffer:a.value,fixed:!1},{default:h(({item:n})=>[T("div",fe,O(n.msg),1)]),_:1},8,["data","min-item-height","buffer"])])])}}},me=C(de,[["__scopeId","data-v-8b02d506"]]);const ce=x=>(ie("data-v-111c59da"),x=x(),ae(),x),he=ce(()=>T("div",{class:"title"},"虚拟列表",-1)),_e={__name:"index",setup(x){return(e,d)=>{const c=V("el-tab-pane"),a=V("el-tabs");return B(),L(G,null,[he,o(a,{modelValue:"1"},{default:h(()=>[o(c,{label:"定高",name:"1"},{default:h(()=>[o(re)]),_:1}),o(c,{label:"非定高",name:"2",lazy:""},{default:h(()=>[o(me)]),_:1})]),_:1})],64)}}},ge=C(_e,[["__scopeId","data-v-111c59da"]]);export{ge as default};
