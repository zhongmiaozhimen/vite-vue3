import{_ as Q,a as c,l as $,o as b,c as S,f as q,n as E,F as U,k as X,m as Y,q as Z,e as ee,t as te,h as le,T as ie,i as oe,s as M}from"./index-81f8df50.js";const ae={class:"virtual-list"},ne={__name:"index",props:{data:{type:Array,default:()=>[]},height:{type:Number,default:void 0},maxHeight:{type:Number,default:void 0},minItemHeight:{type:Number,default:20},cache:{type:Number,default:2},buffer:{type:Number,default:1},fixed:{type:Boolean,default:!0},showOverflowTooltip:{type:Boolean,default:!1},autoResetScrollBar:{type:Boolean,default:!1}},setup(h,{expose:z}){const t=h;let d=[],n=0;const T=c(0);let f=0,I=0,k=0;const g=c([]);let p=0,r=0,u=0;const x=c(0),m=c(0),w=c(null),y=c(null);let v=[],B=!1;const a=c(null);function A(){if(!t.height&&!t.maxHeight)return;let e=0;return t.fixed?t.height?e=Math.ceil(t.height/f):e=Math.ceil(t.maxHeight/f):t.height?e=Math.ceil(t.height/t.minItemHeight):e=Math.ceil(t.maxHeight/t.minItemHeight),e}function D(){let e=t.cache+t.buffer*2;return e<2&&(e=2),e}function W(){const e=y.value.children,l=[];for(let i=0;i<e.length;i++)l.push(e[i].getBoundingClientRect().height);for(let i=l.length;i<d.length;i++)l.push(t.minItemHeight);return l}function N(){if(!w.value)return 0;const e=w.value.scrollTop;if(e===0)return 0;let l=0;if(t.fixed)l=Math.floor(e/f);else{let i=0;for(let o=0;o<v.length;o++){if(i+=v[o],e===i){l=o+1;break}if(e<i){l=o;break}}}return l}function O(e){let l=e-Math.floor(k/2);const i=n-p;l<0?l=0:l>i&&(l=i);let o=l+p-1;const H=n-1;return o>H&&(o=H),{listStartIndex:l,listEndIndex:o}}function j(){if(d=t.data.map((e,l)=>({id:`${Date.now()}-${l}`,data:e})),n=d.length,n===0){g.value=[];return}T.value=t.height?null:t.maxHeight,t.fixed?(g.value=d.slice(0,p||1),M(()=>{f=y.value.children[0].clientHeight,C()})):C()}function C(){if(I=A(),k=D(),p=I+k,p>=n){g.value=d,x.value=0,m.value=0;return}const e=N(),{listStartIndex:l,listEndIndex:i}=O(e);r=l,u=i,x.value=r*f,t.fixed?m.value=(n-u-1)*f:m.value=(n-u-1)*t.minItemHeight,g.value=d.slice(r,u+1),t.fixed||M(()=>{v=W()})}function G(){let e=N();const l=e-r;if(u+1-e-I>t.buffer&&l>t.buffer)return;const{listStartIndex:o,listEndIndex:H}=O(e);if(o!==r)if(r=o,u=H,g.value=d.slice(r,u+1),t.fixed)x.value=r*f,m.value=(n-u-1)*f;else{let V=0;for(let s=0;s<r;s++)V+=v[s];x.value=V;let F=0;for(let s=u+1;s<n;s++)F+=v[s];m.value=F,M(()=>{const s=y.value.children,_=[];for(let L=0;L<s.length;L++)_.push(s[L].getBoundingClientRect().height);v.splice(r,_.length,..._)})}}function R(){w.value&&(w.value.scrollTop=0)}$(()=>t.data,()=>{t.autoResetScrollBar&&R(),j()},{immediate:!0,deep:!0}),$([()=>t.height,()=>t.maxHeight],()=>{T.value=t.height?null:t.maxHeight,C()});function J(){t.showOverflowTooltip&&(a.value=null),!B&&(B=!0,requestAnimationFrame(()=>{B=!1}),!(p>=n)&&G())}function K(e){if(!(!t.showOverflowTooltip||e.target===e.currentTarget||a.value&&(a.value.contains(e.fromElement)||!a.value.contains(e.target)))&&(a.value=e.target,e.target.parentElement!==e.currentTarget)){const l=e.currentTarget.children;for(let i=0;i<l.length;i++)if(l[i].contains(e.target)){a.value=l[i];break}}}function P(e){!t.showOverflowTooltip||a.value&&(!a.value.contains(e.target)||a.value.contains(e.toElement))||(a.value=null)}return z({resetScrollBar:R}),(e,l)=>(b(),S("div",ae,[q("div",{ref_key:"listWrapRef",ref:w,class:"list-wrap",style:E({height:h.height?h.height+"px":"","max-height":T.value?T.value+"px":""}),onScroll:J},[q("ul",{ref_key:"listRef",ref:y,style:E({"padding-top":x.value+"px","padding-bottom":m.value+"px"}),onMouseover:K,onMouseout:P},[(b(!0),S(U,null,X(g.value,i=>(b(),S("li",{key:i.id,class:Y(["list-item",{tooltip:t.showOverflowTooltip}]),style:E({"white-space":h.fixed?"nowrap":"normal","word-break":h.fixed?"normal":"break-all",overflow:h.fixed?"hidden":"visible"})},[Z(e.$slots,"default",{item:i.data},()=>[ee(te(i),1)],!0)],6))),128))],36)],36),t.showOverflowTooltip?(b(),le(ie,{key:0,"mouseenter-el":a.value,enterable:!1,"teleport-to-body":!1},null,8,["mouseenter-el"])):oe("",!0)]))}},se=Q(ne,[["__scopeId","data-v-bec02f35"]]);export{se as V};
