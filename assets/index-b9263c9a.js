import{_ as W,r as g,n as q,w as G,o as L,c as C,a as O,b as A,F as J,d as ie,e as ae,f as oe,g as N,t as D,h as ue,T as re,i as se,j as K,k as H,l as o,m,p as fe,q as de}from"./index-b52a4a79.js";const ce={class:"virtual-list"},me={__name:"virtual-list",props:{data:{type:Array,default:()=>[]},height:{type:Number,default:void 0},maxHeight:{type:Number,default:void 0},minItemHeight:{type:Number,default:20},buffer:{type:Number,default:1},fixed:{type:Boolean,default:!0},showOverflowTooltip:{type:Boolean,default:!1}},setup(p){const e=p;let f=P(),i=f.length;const _=g(e.height?null:e.maxHeight);let v=0,b=0,l=0;const n=g([]);let u=0,d=0;const I=g(0),x=g(0);let a=0;const j=g(null),R=g(null);let M=[],z=!1;const F=g(null),B=g(!1),$=g(null);let s=null,V=null;Z();function P(){return e.data.map((t,r)=>({id:`${Date.now()}-${r}`,data:t}))}function k(){n.value=f,I.value=0,x.value=0,a=0}function X(){if(!e.height&&!e.maxHeight)return;let t=0;return e.fixed?e.height?t=Math.ceil(e.height/v):t=Math.ceil(e.maxHeight/v):e.height?t=Math.ceil(e.height/e.minItemHeight):t=Math.ceil(e.maxHeight/e.minItemHeight),t}function Y(){const t=R.value.children,r=[];for(let c=0;c<t.length;c++)r.push(t[c].getBoundingClientRect().height);for(let c=r.length;c<f.length;c++)r.push(e.minItemHeight);return r}function Z(){if(i<=2||!e.height&&!e.maxHeight||!e.fixed&&!e.minItemHeight){k();return}if(e.fixed){n.value=f.slice(0,1),q(()=>{v=R.value.children[0].clientHeight,E()});return}E()}function E(){if(b=X(),l=e.buffer*2||1,b+l>=i){k();return}const t=b+l;u=0,d=t-1,I.value=0,e.fixed?x.value=(i-t)*v:x.value=(i-t)*e.minItemHeight,n.value=f.slice(u,d+1),a=0,e.fixed||q(()=>{M=Y()})}function ee(t){let r=0;if(e.fixed)r=Math.floor(t/v);else{let w=0;for(let y=0;y<M.length;y++){if(w+=M[y],t===w){r=y+1;break}if(t<w){r=y;break}}}if(t>a){if(a=t,d+1-r-b>e.buffer)return}else if(t<a){if(a=t,r-u>e.buffer)return}else return;l%2?u=r-Math.floor(l/2):u=r-l/2;const c=i-n.value.length;u<0?u=0:u>c&&(u=c),d=u+n.value.length-1;const S=i-1;if(d>S&&(d=S),n.value=f.slice(u,d+1),e.fixed)I.value=u*v,x.value=(i-d-1)*v;else{let w=0;for(let h=0;h<u;h++)w+=M[h];I.value=w;let y=0;for(let h=d+1;h<i;h++)y+=M[h];x.value=y,q(()=>{const h=R.value.children,T=[];for(let U=0;U<h.length;U++)T.push(h[U].getBoundingClientRect().height);M.splice(u,T.length,...T)})}}G(()=>e.data,()=>{if(j.value&&(j.value.scrollTop=0),f=P(),i=f.length,i<=2||!e.height&&!e.maxHeight||!e.fixed&&!e.minItemHeight){k();return}E()}),G([()=>e.height,()=>e.maxHeight],()=>{if(i<=2||!e.height&&!e.maxHeight||!e.fixed&&!e.minItemHeight){k();return}_.value=e.height?null:e.maxHeight,E()});function te(t){s=null,e.showOverflowTooltip&&B.value&&(clearTimeout(V),V=null,$.value=null,B.value=!1),!(i<=2||!e.height&&!e.maxHeight||n.value.length>=i||!e.fixed&&!e.minItemHeight)&&(z||(z=!0,requestAnimationFrame(()=>{z=!1}),ee(t.target.scrollTop)))}function le(t){if(!e.showOverflowTooltip||t.target===t.currentTarget||s&&(s.contains(t.fromElement)||!s.contains(t.target)))return;if(s=t.target,t.target.parentElement!==t.currentTarget){const h=t.currentTarget.children;for(let T=0;T<h.length;T++)if(h[T].contains(t.target)){s=h[T];break}}if(B.value&&$.value&&s&&$.value===s){clearTimeout(V),V=null,F.value.updateOpacity(1);return}const r=document.createRange();r.setStart(s,0),r.setEnd(s,s.childNodes.length);const c=r.getBoundingClientRect().width,S=window.getComputedStyle(s),w=parseInt(S.getPropertyValue("padding-left"))+parseInt(S.getPropertyValue("padding-right")),y=s.getBoundingClientRect().width;c+w-y>.02?(clearTimeout(V),V=null,$.value=s,B.value=!0):($.value=null,B.value=!1)}function ne(t){!e.showOverflowTooltip||s&&(!s.contains(t.target)||s.contains(t.toElement))||(s=null,!(!B.value||V)&&(F.value.updateOpacity(0),V=setTimeout(()=>{V=null,$.value=null,B.value=!1},200)))}return(t,r)=>(L(),C("div",ce,[O("div",{ref_key:"listWrapRef",ref:j,class:"list-wrap",style:A({height:p.height?p.height+"px":"","max-height":_.value?_.value+"px":""}),onScroll:te},[O("ul",{ref_key:"listRef",ref:R,style:A({"padding-top":I.value+"px","padding-bottom":x.value+"px"}),onMouseover:le,onMouseout:ne},[(L(!0),C(J,null,ie(n.value,c=>(L(),C("li",{key:c.id,class:ae(["list-item",{tooltip:e.showOverflowTooltip}]),style:A({"white-space":p.fixed?"nowrap":"normal","word-break":p.fixed?"normal":"break-all",overflow:p.fixed?"hidden":"visible"})},[oe(t.$slots,"default",{items:c.data},()=>[N(D(c),1)],!0)],6))),128))],36)],36),e.showOverflowTooltip&&B.value?(L(),ue(re,{key:0,ref_key:"tooltipRef",ref:F,"reference-el":$.value,enterable:!1,"teleport-to-body":!1},null,8,["reference-el"])):se("",!0)]))}},Q=W(me,[["__scopeId","data-v-b115a951"]]);const he={class:"wrap"},pe=500,ge={__name:"fixed-virtual-list",setup(p){const e=K({total:1e3,buffer:0}),f=g([]),i=g(0);_();function _(){f.value=[];for(let l=1;l<=e.total;l++)f.value.push({msg:`${l} --- ${v()}`});i.value=e.buffer}function v(){const l=["abcdefg","hijklmn","opq","rst","uvw","xyz","1","2","3","4"],n=Math.ceil(Math.random()*10);return l.slice(0,n).join("")}function b(l){e[l]!==""&&typeof e[l]=="string"&&(e[l]=e[l].replace(/[^0-9]/g,"").replace(/^0+(?=\d)/,""),e[l]=Number(e[l]))}return(l,n)=>{const u=H("el-input"),d=H("el-form-item"),I=H("el-button"),x=H("el-form");return L(),C("div",null,[o(x,{inline:""},{default:m(()=>[o(d,{label:"列表总数"},{default:m(()=>[o(u,{modelValue:e.total,"onUpdate:modelValue":n[0]||(n[0]=a=>e.total=a),modelModifiers:{number:!0},placeholder:"请输入列表总数",maxlength:"6",onBlur:n[1]||(n[1]=a=>b("total"))},null,8,["modelValue"])]),_:1}),o(d,{label:"缓冲量"},{default:m(()=>[o(u,{modelValue:e.buffer,"onUpdate:modelValue":n[2]||(n[2]=a=>e.buffer=a),modelModifiers:{number:!0},placeholder:"请输入滚动时的缓冲量",maxlength:"5",onBlur:n[3]||(n[3]=a=>b("buffer"))},null,8,["modelValue"])]),_:1}),o(d,null,{default:m(()=>[o(I,{type:"primary",onClick:_},{default:m(()=>[N("更新列表")]),_:1})]),_:1})]),_:1}),O("div",he,[o(Q,{data:f.value,"max-height":pe,buffer:i.value,"show-overflow-tooltip":""},{default:m(({items:a})=>[N(D(a.msg)+"345555555555555555555555555555555555555555555555555555 ",1)]),_:1},8,["data","buffer"])])])}}},_e=W(ge,[["__scopeId","data-v-1ef5323f"]]);const ve={class:"wrap"},be=500,xe={__name:"dynamic-virtual-list",setup(p){const e=K({total:1e3,buffer:0}),f=g([]),i=g(0);_();function _(){f.value=[];for(let l=1;l<=e.total;l++)f.value.push({msg:`${l} --- ${v()}`});i.value=e.buffer}function v(){const l=["道可道也，非恒道也。","名可名也，非恒名也。","无名万物之始也，有名万物之母也。","故：恒无欲也，以观其眇；","恒有欲也，以观其徼。","两者同出，异名同谓。玄之又玄，众妙之门。","天下皆知美之为美，恶矣，皆知善之为善，斯不善矣。","有无之相生也，难易之相成也，长短之相形也，高下之相盈也，音声之相和也，先后之相随也。","是以圣人居无为之事，行不言之教。","万物作而弗始也，为而弗恃也，成功而弗居也，夫唯弗居，是以弗去。"],n=Math.ceil(Math.random()*10);return l.slice(0,n).join("")}function b(l){typeof e[l]=="string"&&(e[l]=e[l].replace(/[^0-9]/g,"").replace(/^0+(?=\d)/,""),e[l]=Number(e[l]))}return(l,n)=>{const u=H("el-input"),d=H("el-form-item"),I=H("el-button"),x=H("el-form");return L(),C("div",null,[o(x,{inline:""},{default:m(()=>[o(d,{label:"列表总数"},{default:m(()=>[o(u,{modelValue:e.total,"onUpdate:modelValue":n[0]||(n[0]=a=>e.total=a),modelModifiers:{number:!0},placeholder:"请输入列表总数",maxlength:"6",onBlur:n[1]||(n[1]=a=>b("total"))},null,8,["modelValue"])]),_:1}),o(d,{label:"缓冲量"},{default:m(()=>[o(u,{modelValue:e.buffer,"onUpdate:modelValue":n[2]||(n[2]=a=>e.buffer=a),placeholder:"请输入滚动时的缓冲量",maxlength:"5",onBlur:n[3]||(n[3]=a=>b("buffer"))},null,8,["modelValue"])]),_:1}),o(d,null,{default:m(()=>[o(I,{type:"primary",onClick:_},{default:m(()=>[N("更新列表")]),_:1})]),_:1})]),_:1}),O("div",ve,[o(Q,{data:f.value,"max-height":be,buffer:i.value,fixed:!1},{default:m(({items:a})=>[N(D(a.msg),1)]),_:1},8,["data","buffer"])])])}}},we=W(xe,[["__scopeId","data-v-9e44ceea"]]);const ye=p=>(fe("data-v-42faf1d4"),p=p(),de(),p),He=ye(()=>O("div",{class:"title"},"虚拟列表",-1)),Ie={__name:"index",setup(p){return(e,f)=>{const i=H("el-tab-pane"),_=H("el-tabs");return L(),C(J,null,[He,o(_,{"model-value":"1"},{default:m(()=>[o(i,{label:"定高",name:"1"},{default:m(()=>[o(_e)]),_:1}),o(i,{label:"非定高",name:"2",lazy:""},{default:m(()=>[o(we)]),_:1})]),_:1})],64)}}},Be=W(Ie,[["__scopeId","data-v-42faf1d4"]]);export{Be as default};
