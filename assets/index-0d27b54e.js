import{r as C,x as W,o as w,h as S,y as I,E as ne,m as t,l as e,z as se,A as le,B as te,C as ue,c as j,F as K,d as oe,D as ie,G as ae,k,H,g as O,I as A,n as J,p as Q,q as X,a as m,_ as F,e as de,i as Y}from"./index-208daab3.js";const re={__name:"cell-input",props:{value:{type:String,default:""},autofocus:{type:Boolean,default:!0}},emits:["updateValue"],setup(a,{emit:v}){const r=a,n=C(null),_=C(r.value);function h(){n.value.focus()}function s(){_.value=_.value.trim(),v("updateValue",_.value)}return W(()=>{r.autofocus&&h()}),(l,o)=>(w(),S(I(ne),{ref_key:"inputRef",ref:n,modelValue:_.value,"onUpdate:modelValue":[o[0]||(o[0]=i=>_.value=i),o[1]||(o[1]=i=>l.$emit("updateValue",i))],placeholder:"请输入",onBlur:s},null,8,["modelValue"]))}},Z={__name:"cell-date",props:{value:{type:String,default:""},autofocus:{type:Boolean,default:!0}},emits:["updateValue"],setup(a,{expose:v}){const r=a,n=C(null),_=C(r.value),h=C(null),s=`date-prper-${Date.now()}`;function l(){n.value.focus()}return W(()=>{r.autofocus&&l(),h.value=document.querySelector(`.${s}`)}),v({popperEl:h}),(o,i)=>(w(),S(I(te),{locale:I(le)},{default:t(()=>[e(I(se),{ref_key:"dateRef",ref:n,modelValue:_.value,"onUpdate:modelValue":[i[0]||(i[0]=u=>_.value=u),i[1]||(i[1]=u=>o.$emit("updateValue",u))],type:"date","value-format":"YYYY-MM-DD",placeholder:"选择日期","popper-class":s},null,8,["modelValue"])]),_:1},8,["locale"]))}},ce={__name:"cell-select",props:{value:{type:String,default:""},options:{type:Array,default:()=>[]},autofocus:{type:Boolean,default:!0}},emits:["updateValue"],setup(a){const v=a,r=C(null),n=C(v.value);function _(){r.value.toggleMenu()}return W(()=>{v.autofocus&&_()}),(h,s)=>(w(),S(I(te),{locale:I(le)},{default:t(()=>[e(I(ue),{ref_key:"selectRef",ref:r,modelValue:n.value,"onUpdate:modelValue":[s[0]||(s[0]=l=>n.value=l),s[1]||(s[1]=l=>h.$emit("updateValue",l))],placeholder:"请选择",clearable:"",filterable:""},{default:t(()=>[(w(!0),j(K,null,oe(a.options,l=>(w(),S(I(ie),{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["locale"]))}},B=a=>(Q("data-v-f3d088ea"),a=a(),X(),a),pe=B(()=>m("i",{class:"required"},"*",-1)),fe=B(()=>m("span",{class:"label"},"日期",-1)),ve=B(()=>m("i",{class:"required"},"*",-1)),_e=B(()=>m("span",{class:"label"},"名字",-1)),me=B(()=>m("i",{class:"required"},"*",-1)),ye=B(()=>m("span",{class:"label"},"省份",-1)),be=B(()=>m("i",{class:"required"},"*",-1)),he=B(()=>m("span",{class:"label"},"城市",-1)),Ee=B(()=>m("i",{class:"required"},"*",-1)),Ve=B(()=>m("span",{class:"label"},"地址",-1)),Ce=B(()=>m("span",{class:"label"},"邮编",-1)),we={__name:"index",setup(a){const v=C(null),r=C([{date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000"},{date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000"},{date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000"},{date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000"}]),n=[{province:"黑龙江",citys:["哈尔滨","齐齐哈尔","鸡西","鹤岗"]},{province:"吉林",citys:["长春","通化","白山","四平"]},{province:"辽宁",citys:["辽阳","大连","鞍山","抚顺"]}],_=["date","name","province","city","address","zip"],h=["date","name","province","city","address"];let s=null;const l={colProp:"",value:"",els:null};function o(c,x,f){var b;const p=x.property;if(!_.includes(p)||(b=l.els)!=null&&b[0].contains(f))return;i(),f.style.padding=0,f.classList.remove("success","error");const E=f.firstElementChild;E.style.display="none",E.classList.remove("el-tooltip");const q=v.value.layout.table.refs.tableWrapper.querySelector(".el-popper");if(q&&(q.style.display="none"),l.value=c[p],p==="date"){const d=e(Z,{value:l.value,onUpdateValue:y=>{l.value=y}});A(d,f),l.els=[f,d.component.exposed.popperEl.value]}else if(p==="province"||p==="city"){let d=[];if(p==="province")d=n.map(g=>g.province);else if(p==="city"&&c.province){const{citys:g}=n.find(D=>D.province===c.province);d=g}const y=e(ce,{value:l.value,options:d,onUpdateValue:g=>{l.value=g}});A(y,f),l.els=[f,y.component.refs.selectRef.popperPaneRef]}else{const d=e(re,{value:l.value,onUpdateValue:y=>{l.value=y}});A(d,f),l.els=[f]}s=c,l.colProp=p}function i(){if(!l.els)return;const c=l.els[0];h.includes(l.colProp)&&(s[l.colProp]!==l.value&&l.value&&c.classList.add("success"),l.value||c.classList.add("error")),s[l.colProp]=l.value,A(null,c),c.style.padding="8px 0";const x=c.firstElementChild;x.style.display="block",x.classList.add("el-tooltip"),l.els=null,s=null,l.colProp="",l.value=""}function u(){const c=l.value;if(!c){s.city="";return}const x=s.city,{citys:f}=n.find(p=>p.province===c);f.includes(x)||(s.city="")}function P(){l.colProp==="province"&&u(),i(),r.value.push({date:"",name:"",province:"",city:"",address:"",zip:""}),J(()=>{const c=v.value.layout.table.refs.tableBody;v.value.setScrollTop(c.clientHeight);const x=c.querySelectorAll("tbody .el-table__row"),p=x[x.length-1].children[1];p.style.padding=0;const E=p.firstElementChild;E.style.display="none",E.classList.remove("el-tooltip"),l.value="",s=r.value[r.value.length-1],l.colProp="date";const V=e(Z,{value:l.value,autofocus:!1,onUpdateValue:q=>{l.value=q}});A(V,p),l.els=[p,V.component.exposed.popperEl.value]})}function $(c){!l.els||l.els.some(f=>f.contains(c.target))||(l.colProp==="province"&&u(),i())}function U(){const x=v.value.layout.table.refs.tableBody.querySelectorAll("tbody .el-table__row");let f=!1,p=null;for(let E=0;E<x.length;E++){p=x[E].children;for(let V=0;V<p.length;V++)p[V].classList.contains("required")&&!p[V].innerText&&(p[V].classList.add("error"),f=!0)}}return W(()=>{document.addEventListener("click",$)}),ae(()=>{document.removeEventListener("click",$)}),(c,x)=>{const f=k("el-button"),p=k("el-row"),E=k("el-table-column"),V=k("EditPen"),q=k("el-icon"),b=k("el-table");return w(),j("div",null,[e(p,{justify:"end"},{default:t(()=>[e(f,{type:"primary",plain:"",onClick:H(P,["stop"])},{default:t(()=>[O("新增")]),_:1},8,["onClick"])]),_:1}),e(b,{ref_key:"tableRef",ref:v,data:r.value,border:"",stripe:"","max-height":"500",onCellClick:o},{default:t(()=>[e(E,{type:"index",fixed:"",label:"序号",width:"80"}),e(E,{prop:"date",label:"日期","min-width":"140","show-overflow-tooltip":""},{header:t(()=>[pe,fe,e(q,null,{default:t(()=>[e(V)]),_:1})]),_:1}),e(E,{prop:"name",label:"名字","min-width":"120","show-overflow-tooltip":""},{header:t(()=>[ve,_e,e(q,null,{default:t(()=>[e(V)]),_:1})]),_:1}),e(E,{prop:"province",label:"省份","min-width":"120","show-overflow-tooltip":""},{header:t(()=>[me,ye,e(q,null,{default:t(()=>[e(V)]),_:1})]),_:1}),e(E,{prop:"city",label:"城市","min-width":"120","show-overflow-tooltip":""},{header:t(()=>[be,he,e(q,null,{default:t(()=>[e(V)]),_:1})]),_:1}),e(E,{prop:"address",label:"地址","min-width":"180","show-overflow-tooltip":""},{header:t(()=>[Ee,Ve,e(q,null,{default:t(()=>[e(V)]),_:1})]),_:1}),e(E,{prop:"zip",label:"邮编","min-width":"120","show-overflow-tooltip":""},{header:t(()=>[Ce,e(q,null,{default:t(()=>[e(V)]),_:1})]),_:1})]),_:1},8,["data"]),e(p,{justify:"center",class:"mg-top-20"},{default:t(()=>[e(f,{type:"primary",onClick:H(U,["stop"])},{default:t(()=>[O("保存")]),_:1},8,["onClick"])]),_:1})])}}};const ke=F(we,[["__scopeId","data-v-f3d088ea"]]),G={__name:"cell-input",props:{modelValue:{type:String,default:""},autofocus:{type:Boolean,default:!0}},emits:["update:model-value"],setup(a,{emit:v}){const r=a,n=C(null);function _(){n.value.focus()}function h(){const s=r.modelValue.trim();v("update:model-value",s)}return W(()=>{r.autofocus&&_()}),(s,l)=>{const o=k("el-input");return w(),S(o,{ref_key:"inputRef",ref:n,"model-value":a.modelValue,placeholder:"请输入","onUpdate:modelValue":l[0]||(l[0]=i=>s.$emit("update:model-value",i)),onBlur:h},null,8,["model-value"])}}};const ge={__name:"cell-date",props:{modelValue:{type:String,default:""},autofocus:{type:Boolean,default:!0}},emits:["update:model-value"],setup(a,{expose:v}){const r=a,n=C(null);let _=null,h=null;const s=`date-picker-wrap-${Date.now()}`,l=`date-prper-${Date.now()}`;function o(){n.value.focus()}function i(){return _}function u(){return h}return W(()=>{r.autofocus&&o(),_=document.querySelector(`.${s}`),h=document.querySelector(`.${l}`)}),v({getDatePickerWrapEl:i,getPrpprtEl:u}),(P,$)=>{const U=k("el-date-picker");return w(),j("div",{class:de(["date-picker-wrap",s])},[e(U,{ref_key:"dateRef",ref:n,"model-value":a.modelValue,type:"date","value-format":"YYYY-MM-DD",placeholder:"选择日期","popper-class":l,"onUpdate:modelValue":$[0]||($[0]=c=>P.$emit("update:model-value",c))},null,8,["model-value"])],2)}}},$e=F(ge,[["__scopeId","data-v-eb4a81bb"]]),ee={__name:"cell-select",props:{modelValue:{type:String,default:""},options:{type:Array,default:()=>[]},autofocus:{type:Boolean,default:!0}},emits:["update:model-value"],setup(a,{expose:v}){const r=a,n=C(null);function _(){n.value.toggleMenu()}function h(){return n.value.popperPaneRef}return W(()=>{r.autofocus&&_()}),v({getPrpprtEl:h}),(s,l)=>{const o=k("el-option"),i=k("el-select");return w(),S(i,{ref_key:"selectRef",ref:n,"model-value":a.modelValue,placeholder:"请选择",clearable:"",filterable:"","onUpdate:modelValue":l[0]||(l[0]=u=>s.$emit("update:model-value",u))},{default:t(()=>[(w(!0),j(K,null,oe(a.options,u=>(w(),S(o,{key:u,label:u,value:u},null,8,["label","value"]))),128))]),_:1},8,["model-value"])}}},z=a=>(Q("data-v-c0da13e6"),a=a(),X(),a),xe=z(()=>m("i",{class:"required"},"*",-1)),Re=z(()=>m("span",{class:"label"},"日期",-1)),Pe=z(()=>m("i",{class:"required"},"*",-1)),qe=z(()=>m("span",{class:"label"},"名字",-1)),Le=z(()=>m("i",{class:"required"},"*",-1)),Se=z(()=>m("span",{class:"label"},"省份",-1)),Be=z(()=>m("i",{class:"required"},"*",-1)),ze=z(()=>m("span",{class:"label"},"城市",-1)),Ue=z(()=>m("i",{class:"required"},"*",-1)),De=z(()=>m("span",{class:"label"},"地址",-1)),Ie=z(()=>m("span",{class:"label"},"邮编",-1)),Me={__name:"index",setup(a){const v=C(null),r=C([{id:"1",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000"},{id:"2",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000"},{id:"3",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000"},{id:"4",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000"}]),n=[{province:"黑龙江",citys:["哈尔滨","齐齐哈尔","鸡西","鹤岗"]},{province:"吉林",citys:["长春","通化","白山","四平"]},{province:"辽宁",citys:["辽阳","大连","鞍山","抚顺"]}];let _=[],h=[];const s=["date","name","province","city","address","zip"],l=["date","name","province","city","address"],o=C(""),i=C(""),u=C("");let P=null,$=[];const U=C(null),c=C(!0);function x(b,d,y){var T;const g=d.property;if(!s.includes(g)||(T=$[0])!=null&&T.contains(y))return;f(),y.classList.add("editor"),y.classList.remove("success","error"),y.firstElementChild.classList.remove("el-tooltip");const M=v.value.layout.table.refs.tableWrapper.querySelector(".el-popper");if(M&&(M.style.display="none"),g==="province"&&(_=n.map(R=>R.province)),g==="city")if(b.province){const{citys:R}=n.find(L=>L.province===b.province);h=R}else h=[];P=b,i.value=b.id,u.value=g,o.value=b[g],$=[y],c.value=!0,J(()=>{(g==="date"||g==="province"||g==="city")&&$.push(U.value.getPrpprtEl())})}function f(){if($.length===0)return;const b=$[0];l.includes(u.value)&&(o.value?P[u.value]!==o.value&&b.classList.add("success"):b.classList.add("error")),$[0].classList.remove("editor"),b.firstElementChild.classList.add("el-tooltip"),P[u.value]=o.value,P=null,i.value="",u.value="",o.value="",$=[],c.value=!0}function p(){if(!o.value){P.city="";return}const b=P.city,{citys:d}=n.find(y=>y.province===o.value);d.includes(b)||(P.city="")}function E(){u.value==="province"&&p(),f(),r.value.push({id:`${Date.now()}-${r.value.length+1}`,date:"",name:"",province:"",city:"",address:"",zip:""}),P=r.value[r.value.length-1],i.value=P.id,u.value="date",o.value=P.date,c.value=!1,J(()=>{const b=v.value.layout.table.refs.tableBody;v.value.setScrollTop(b.clientHeight);const y=U.value.getDatePickerWrapEl().parentElement.parentElement;y.classList.add("editor"),$=[y,U.value.getPrpprtEl()]})}function V(b){$.length===0||$.some(y=>y.contains(b.target))||(u.value==="province"&&p(),f())}function q(){}return W(()=>{document.addEventListener("mouseup",V)}),ae(()=>{document.removeEventListener("mouseup",V)}),(b,d)=>{const y=k("el-button"),g=k("el-row"),D=k("el-table-column"),N=k("EditPen"),M=k("el-icon"),T=k("el-table");return w(),j("div",null,[e(g,{justify:"end"},{default:t(()=>[e(y,{type:"primary",plain:"",onClick:H(E,["stop"])},{default:t(()=>[O("新增")]),_:1},8,["onClick"])]),_:1}),e(T,{ref_key:"tableRef",ref:v,data:r.value,border:"",stripe:"","max-height":"500",onCellClick:x},{default:t(()=>[e(D,{type:"index",fixed:"",label:"序号",width:"80"}),e(D,{prop:"date",label:"日期","min-width":"140","show-overflow-tooltip":""},{header:t(()=>[xe,Re,e(M,null,{default:t(()=>[e(N)]),_:1})]),default:t(({row:R})=>[i.value===R.id&&u.value==="date"?(w(),S($e,{key:0,ref_key:"editCellRef",ref:U,modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=L=>o.value=L),autofocus:c.value},null,8,["modelValue","autofocus"])):Y("",!0)]),_:1}),e(D,{prop:"name",label:"名字","min-width":"120","show-overflow-tooltip":""},{header:t(()=>[Pe,qe,e(M,null,{default:t(()=>[e(N)]),_:1})]),default:t(({row:R})=>[i.value===R.id&&u.value==="name"?(w(),S(G,{key:0,modelValue:o.value,"onUpdate:modelValue":d[1]||(d[1]=L=>o.value=L)},null,8,["modelValue"])):Y("",!0)]),_:1}),e(D,{prop:"province",label:"省份","min-width":"120","show-overflow-tooltip":""},{header:t(()=>[Le,Se,e(M,null,{default:t(()=>[e(N)]),_:1})]),default:t(({row:R})=>[i.value===R.id&&u.value==="province"?(w(),S(ee,{key:0,ref_key:"editCellRef",ref:U,modelValue:o.value,"onUpdate:modelValue":d[2]||(d[2]=L=>o.value=L),options:I(_)},null,8,["modelValue","options"])):Y("",!0)]),_:1}),e(D,{prop:"city",label:"城市","min-width":"120","show-overflow-tooltip":""},{header:t(()=>[Be,ze,e(M,null,{default:t(()=>[e(N)]),_:1})]),default:t(({row:R})=>[i.value===R.id&&u.value==="city"?(w(),S(ee,{key:0,ref_key:"editCellRef",ref:U,modelValue:o.value,"onUpdate:modelValue":d[3]||(d[3]=L=>o.value=L),options:I(h)},null,8,["modelValue","options"])):Y("",!0)]),_:1}),e(D,{prop:"address",label:"地址","min-width":"180","show-overflow-tooltip":""},{header:t(()=>[Ue,De,e(M,null,{default:t(()=>[e(N)]),_:1})]),default:t(({row:R})=>[i.value===R.id&&u.value==="address"?(w(),S(G,{key:0,modelValue:o.value,"onUpdate:modelValue":d[4]||(d[4]=L=>o.value=L)},null,8,["modelValue"])):Y("",!0)]),_:1}),e(D,{prop:"zip",label:"邮编","min-width":"120","show-overflow-tooltip":""},{header:t(()=>[Ie,e(M,null,{default:t(()=>[e(N)]),_:1})]),default:t(({row:R})=>[i.value===R.id&&u.value==="zip"?(w(),S(G,{key:0,modelValue:o.value,"onUpdate:modelValue":d[5]||(d[5]=L=>o.value=L)},null,8,["modelValue"])):Y("",!0)]),_:1})]),_:1},8,["data"]),e(g,{justify:"center",class:"mg-top-20"},{default:t(()=>[e(y,{type:"primary",onClick:H(q,["stop"])},{default:t(()=>[O("保存")]),_:1},8,["onClick"])]),_:1})])}}};const We=F(Me,[["__scopeId","data-v-c0da13e6"]]);const Ne=a=>(Q("data-v-87e6bb6f"),a=a(),X(),a),Ye=Ne(()=>m("div",{class:"title"},"表单编辑",-1)),je={__name:"index",setup(a){return(v,r)=>{const n=k("el-tab-pane"),_=k("el-tabs");return w(),j(K,null,[Ye,e(_,{"model-value":"1"},{default:t(()=>[e(n,{label:"单元格编辑",name:"1"},{default:t(()=>[e(ke)]),_:1}),e(n,{label:"单元格编辑2",name:"2",lazy:""},{default:t(()=>[e(We)]),_:1})]),_:1})],64)}}},Te=F(je,[["__scopeId","data-v-87e6bb6f"]]);export{Te as default};
