import{r as f,y as W,k as g,o as d,h as J,_ as K,c as v,l as e,e as M,m as l,F as ae,d as pe,x as fe,z as ee,g as te,a as m,A as O,t as I,v as ve,B as _e,n as le,p as ne,q as se}from"./index-31be2dc8.js";const G={__name:"cell-input",props:{modelValue:{type:String,default:""},autofocus:{type:Boolean,default:!0}},emits:["update:model-value"],setup(u,{emit:C}){const V=u,_=f(null);function k(){_.value.focus()}function $(){const r=V.modelValue.trim();C("update:model-value",r)}return W(()=>{V.autofocus&&k()}),(r,b)=>{const w=g("el-input");return d(),J(w,{ref_key:"inputRef",ref:_,"model-value":u.modelValue,placeholder:"请输入","onUpdate:modelValue":b[0]||(b[0]=B=>r.$emit("update:model-value",B)),onBlur:$},null,8,["model-value"])}}};const me={__name:"cell-date",props:{modelValue:{type:String,default:""},autofocus:{type:Boolean,default:!0}},emits:["update:model-value"],setup(u,{expose:C}){const V=u,_=f(null);let k=null,$=null;const r=`date-picker-wrap-${Date.now()}`,b=`date-prper-${Date.now()}`;function w(){_.value.focus()}function B(){return k}function P(){return $}return W(()=>{V.autofocus&&w(),k=document.querySelector(`.${r}`),$=document.querySelector(`.${b}`)}),C({getDatePickerWrapEl:B,getPrpprtEl:P}),(N,q)=>{const a=g("el-date-picker");return d(),v("div",{class:M(["date-picker-wrap",r])},[e(a,{ref_key:"dateRef",ref:_,"model-value":u.modelValue,type:"date","value-format":"YYYY-MM-DD",placeholder:"选择日期","popper-class":b,"onUpdate:modelValue":q[0]||(q[0]=R=>N.$emit("update:model-value",R))},null,8,["model-value"])],2)}}},ye=K(me,[["__scopeId","data-v-394c5674"]]),oe={__name:"cell-select",props:{modelValue:{type:String,default:""},options:{type:Array,default:()=>[]},autofocus:{type:Boolean,default:!0}},emits:["update:model-value"],setup(u,{expose:C}){const V=u,_=f(null);function k(){_.value.toggleMenu()}function $(){return _.value.popperPaneRef}return W(()=>{V.autofocus&&k()}),C({getPrpprtEl:$}),(r,b)=>{const w=g("el-option"),B=g("el-select");return d(),J(B,{ref_key:"selectRef",ref:_,"model-value":u.modelValue,placeholder:"请选择",clearable:"",filterable:"","onUpdate:modelValue":b[0]||(b[0]=P=>r.$emit("update:model-value",P))},{default:l(()=>[(d(!0),v(ae,null,pe(u.options,P=>(d(),J(w,{key:P,label:P,value:P},null,8,["label","value"]))),128))]),_:1},8,["model-value"])}}};const S=u=>(ne("data-v-bb3757e8"),u=u(),se(),u),he={class:"mg-top-10"},ge=S(()=>m("i",{class:"required"},"*",-1)),ke=S(()=>m("span",{class:"label"},"日期",-1)),be=S(()=>m("i",{class:"required"},"*",-1)),Ce=S(()=>m("span",{class:"label"},"名字",-1)),Ve=S(()=>m("i",{class:"required"},"*",-1)),Re=S(()=>m("span",{class:"label"},"省份",-1)),Ee=S(()=>m("i",{class:"required"},"*",-1)),xe=S(()=>m("span",{class:"label"},"城市",-1)),Se=S(()=>m("i",{class:"required"},"*",-1)),$e=S(()=>m("span",{class:"label"},"地址",-1)),Pe=S(()=>m("span",{class:"label"},"邮编",-1)),Be={key:1,class:"no-editor tooltip"},De={class:"tooltip-wrap"},we={__name:"index",setup(u){const C=f(null),V=f(!1),_=f(null),k=f(""),$=f(!0),r=f([{id:"1",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000"},{id:"2",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000"},{id:"3",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000"},{id:"4",date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000"}]),b=[{province:"黑龙江",citys:["哈尔滨","齐齐哈尔","鸡西","鹤岗"]},{province:"吉林",citys:["长春","通化","白山","四平"]},{province:"辽宁",citys:["辽阳","大连","鞍山","抚顺"]}];let w=[],B=[];const P=["date","name","province","city","address","zip"],N=["date","name","province","city","address"],q=f([]);r.value.forEach(o=>{Q(o.id)});const a=f(""),R=f(""),p=f("");let y=null,D=[];const z=f(null),Y=f(null),j=f(null);let T=!0;function Q(o){let t={id:o};P.forEach(i=>{t[i]=""}),q.value.push(t)}function U(o,t){const i=q.value.find(c=>c.id===o);if(i)return i[t]}function A(o,t,i){const c=q.value.find(n=>n.id===o);c&&(c[t]=i)}function ue(o,t,i,c){var E;const n=t.property;if(!(!P.includes(n)||(E=D[0])!=null&&E.contains(c.target))){if(F(),n==="province"&&(w=b.map(h=>h.province)),n==="city")if(o.province){const{citys:h}=b.find(L=>L.province===o.province);B=h}else B=[];$.value=!1,y=o,R.value=o.id,p.value=n,a.value=o[n],T=!0,le(()=>{D=[z.value],n==="date"?D.push(Y.value.getPrpprtEl()):(n==="province"||n==="city")&&D.push(j.value.getPrpprtEl())})}}function F(){D.length!==0&&(N.includes(p.value)&&(a.value?y[p.value]!==a.value&&A(y.id,p.value,"success"):A(y.id,p.value,"error")),y[p.value]=a.value,y=null,R.value="",p.value="",a.value="",D=[],T=!0)}function X(){if(!a.value){y.city="";return}const o=y.city,{citys:t}=b.find(i=>i.province===a.value);t.includes(o)||(y.city="")}function ie(){p.value==="province"&&X(),F(),r.value.push({id:`${Date.now()}-${r.value.length+1}`,date:"",name:"",province:"",city:"",address:"",zip:""}),y=r.value[r.value.length-1],R.value=y.id,p.value="date",a.value=y.date,T=!1,Q(y.id),le(()=>{const o=C.value.layout.table.refs.tableBody;C.value.setScrollTop(o.clientHeight),C.value.setScrollLeft(0),D=[z.value,Y.value.getPrpprtEl()]})}function de(){let o=!1;r.value.forEach(t=>{for(const i in t)t[i]||(o=!0,A(t.id,i,"error"))})}function Z(o){D.length===0||D.some(i=>i.contains(o.target))||(p.value==="province"&&X(),F())}function ce(o,t,i){const c=i.querySelector(".tooltip");if(!c)return;const n=document.createRange();n.setStart(c,0),n.setEnd(c,c.childNodes.length);const E=n.getBoundingClientRect().width,h=window.getComputedStyle(c),L=parseInt(h.getPropertyValue("padding-left"))+parseInt(h.getPropertyValue("padding-right")),H=c.getBoundingClientRect().width;E+L-H>.02&&($.value=!0,_.value=c,V.value=!0,k.value=c.innerText)}function re(){V.value=!1,k.value="",_.value=null}return W(()=>{document.addEventListener("mouseup",Z)}),fe(()=>{document.removeEventListener("mouseup",Z)}),(o,t)=>{const i=g("el-button"),c=g("el-row"),n=g("el-table-column"),E=g("EditPen"),h=g("el-icon"),L=g("el-table"),H=g("el-tooltip");return d(),v("div",null,[e(c,{justify:"end"},{default:l(()=>[e(i,{type:"primary",plain:"",onClick:ee(ie,["stop"])},{default:l(()=>[te("新增")]),_:1},8,["onClick"])]),_:1}),m("div",he,[e(L,{ref_key:"tableRef",ref:C,data:r.value,border:"",stripe:"","max-height":400,onCellClick:ue,onCellMouseEnter:ce,onCellMouseLeave:re},{default:l(()=>[e(n,{type:"index",fixed:"",label:"序号",width:"80"}),e(n,{prop:"date",label:"日期","min-width":"140","class-name":"editor-column"},{header:l(()=>[ge,ke,e(h,null,{default:l(()=>[e(E)]),_:1})]),default:l(({row:s})=>[R.value===s.id&&p.value==="date"?(d(),v("div",{key:0,ref_key:"editCellRef",ref:z,class:"editor"},[e(ye,{ref_key:"cellDateRef",ref:Y,modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=x=>a.value=x),autofocus:O(T)},null,8,["modelValue","autofocus"])],512)):(d(),v("div",{key:1,class:M(["no-editor","tooltip",U(s.id,"date")])},I(s.date),3))]),_:1}),e(n,{prop:"name",label:"名字","min-width":"120","class-name":"editor-column"},{header:l(()=>[be,Ce,e(h,null,{default:l(()=>[e(E)]),_:1})]),default:l(({row:s})=>[R.value===s.id&&p.value==="name"?(d(),v("div",{key:0,ref_key:"editCellRef",ref:z,class:"editor"},[e(G,{modelValue:a.value,"onUpdate:modelValue":t[1]||(t[1]=x=>a.value=x)},null,8,["modelValue"])],512)):(d(),v("div",{key:1,class:M(["no-editor","tooltip",U(s.id,"name")])},I(s.name),3))]),_:1}),e(n,{prop:"province",label:"省份","min-width":"120","class-name":"editor-column"},{header:l(()=>[Ve,Re,e(h,null,{default:l(()=>[e(E)]),_:1})]),default:l(({row:s})=>[R.value===s.id&&p.value==="province"?(d(),v("div",{key:0,ref_key:"editCellRef",ref:z,class:"editor"},[e(oe,{ref_key:"cellSelectRef",ref:j,modelValue:a.value,"onUpdate:modelValue":t[2]||(t[2]=x=>a.value=x),options:O(w)},null,8,["modelValue","options"])],512)):(d(),v("div",{key:1,class:M(["no-editor","tooltip",U(s.id,"province")])},I(s.province),3))]),_:1}),e(n,{prop:"city",label:"城市","min-width":"120","class-name":"editor-column"},{header:l(()=>[Ee,xe,e(h,null,{default:l(()=>[e(E)]),_:1})]),default:l(({row:s})=>[R.value===s.id&&p.value==="city"?(d(),v("div",{key:0,ref_key:"editCellRef",ref:z,class:"editor"},[e(oe,{ref_key:"cellSelectRef",ref:j,modelValue:a.value,"onUpdate:modelValue":t[3]||(t[3]=x=>a.value=x),options:O(B)},null,8,["modelValue","options"])],512)):(d(),v("div",{key:1,class:M(["no-editor","tooltip",U(s.id,"city")])},I(s.city),3))]),_:1}),e(n,{prop:"address",label:"地址","min-width":"170","class-name":"editor-column"},{header:l(()=>[Se,$e,e(h,null,{default:l(()=>[e(E)]),_:1})]),default:l(({row:s})=>[R.value===s.id&&p.value==="address"?(d(),v("div",{key:0,ref_key:"editCellRef",ref:z,class:"editor"},[e(G,{modelValue:a.value,"onUpdate:modelValue":t[4]||(t[4]=x=>a.value=x)},null,8,["modelValue"])],512)):(d(),v("div",{key:1,class:M(["no-editor","tooltip",U(s.id,"address")])},I(s.address),3))]),_:1}),e(n,{prop:"zip",label:"邮编","min-width":"120","class-name":"editor-column"},{header:l(()=>[Pe,e(h,null,{default:l(()=>[e(E)]),_:1})]),default:l(({row:s})=>[R.value===s.id&&p.value==="zip"?(d(),v("div",{key:0,ref_key:"editCellRef",ref:z,class:"editor"},[e(G,{modelValue:a.value,"onUpdate:modelValue":t[5]||(t[5]=x=>a.value=x)},null,8,["modelValue"])],512)):(d(),v("div",Be,I(s.zip),1))]),_:1})]),_:1},8,["data"]),ve(m("div",De,[e(H,{visible:V.value,"virtual-ref":_.value,"virtual-triggering":"",content:k.value,placement:"top",teleported:!1},null,8,["visible","virtual-ref","content"])],512),[[_e,$.value]])]),e(c,{justify:"center",class:"mg-top-20"},{default:l(()=>[e(i,{type:"primary",onClick:ee(de,["stop"])},{default:l(()=>[te("保存")]),_:1},8,["onClick"])]),_:1})])}}},ze=K(we,[["__scopeId","data-v-bb3757e8"]]);const qe=u=>(ne("data-v-4f018ecd"),u=u(),se(),u),Ie=qe(()=>m("div",{class:"title"},"表单编辑",-1)),Me={__name:"index",setup(u){return(C,V)=>{const _=g("el-tab-pane"),k=g("el-tabs");return d(),v(ae,null,[Ie,e(k,{"model-value":"1"},{default:l(()=>[e(_,{label:"单元格编辑",name:"1"},{default:l(()=>[e(ze)]),_:1})]),_:1})],64)}}},Le=K(Me,[["__scopeId","data-v-4f018ecd"]]);export{Le as default};
