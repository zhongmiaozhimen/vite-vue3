import{r as f,v as S,o as V,x as R,y,E as I,l as h,k as n,z as L,A as U,B as $,c as N,e as M,F as Y,C as q,D as A,G as T,j as x,H as k,p as W,m as j,b as F,I as H,h as O,n as G,_ as J}from"./index-af3ae3cb.js";const K={__name:"cell-input",props:{value:{type:String,default:""},autofocus:{type:Boolean,default:!0}},emits:["updateValue"],setup(c){const p=c,r=f(null),i=f(p.value);function v(){r.value.focus()}return S(()=>{p.autofocus&&v()}),(e,s)=>(V(),R(y(I),{ref_key:"inputRef",ref:r,modelValue:i.value,"onUpdate:modelValue":[s[0]||(s[0]=o=>i.value=o),s[1]||(s[1]=o=>e.$emit("updateValue",o))],placeholder:"请输入"},null,8,["modelValue"]))}},z={__name:"cell-date",props:{value:{type:String,default:""},autofocus:{type:Boolean,default:!0}},emits:["updateValue"],setup(c,{expose:p}){const r=c,i=f(null),v=f(r.value),e=f(null),s=`date-prper-${Date.now()}`;function o(){i.value.focus()}return S(()=>{r.autofocus&&o(),e.value=document.querySelector(`.${s}`)}),p({popperEl:e}),(B,w)=>(V(),R(y($),{locale:y(U)},{default:h(()=>[n(y(L),{ref_key:"dateRef",ref:i,modelValue:v.value,"onUpdate:modelValue":[w[0]||(w[0]=_=>v.value=_),w[1]||(w[1]=_=>B.$emit("updateValue",_))],type:"date","value-format":"YYYY-MM-DD",placeholder:"选择日期","popper-class":s},null,8,["modelValue"])]),_:1},8,["locale"]))}},Q={__name:"cell-select",props:{value:{type:String,default:""},options:{type:Array,default:()=>[]},autofocus:{type:Boolean,default:!0}},emits:["updateValue"],setup(c){const p=c,r=f(null),i=f(p.value);function v(){r.value.toggleMenu()}return S(()=>{p.autofocus&&v()}),(e,s)=>(V(),R(y($),{locale:y(U)},{default:h(()=>[n(y(q),{ref_key:"selectRef",ref:r,modelValue:i.value,"onUpdate:modelValue":[s[0]||(s[0]=o=>i.value=o),s[1]||(s[1]=o=>e.$emit("updateValue",o))],placeholder:"请选择",clearable:"",filterable:""},{default:h(()=>[(V(!0),N(Y,null,M(c.options,o=>(V(),R(y(A),{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["locale"]))}},X=c=>(W("data-v-3804d4a1"),c=c(),j(),c),Z=X(()=>F("div",{class:"title"},"表格编辑",-1)),ee={__name:"index",setup(c){const p=f(null),r=f([{date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000"},{date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000"},{date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000"},{date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000"}]),i=[{province:"黑龙江",citys:["哈尔滨","齐齐哈尔","鸡西","鹤岗"]},{province:"吉林",citys:["长春","通化","白山","四平"]},{province:"辽宁",citys:["辽阳","大连","鞍山","抚顺"]}],v=["date","name","province","city","address","zip"];let e={row:"",colProp:"",els:null,value:""};function s(l,d,a){var P;const t=d.property;if(!v.includes(t)||(P=e.els)!=null&&P[0].contains(a))return;o(),a.style.padding=0;const u=a.firstElementChild;u.style.display="none",u.classList.remove("el-tooltip");const g=p.value.layout.table.refs.tableWrapper.querySelector(".el-popper");if(g&&(g.style.display="none"),e.value=l[t],t==="date"){const m=n(z,{value:e.value,onUpdateValue:b=>{e.value=b}});k(m,a),e.els=[a,m.component.exposed.popperEl.value]}else if(t==="province"||t==="city"){let m=[];if(t==="province")m=i.map(C=>C.province);else if(t==="city"&&l.province){const{citys:C}=i.find(D=>D.province===l.province);m=C}const b=n(Q,{value:e.value,options:m,onUpdateValue:C=>{e.value=C}});k(b,a),e.els=[a,b.component.refs.selectRef.popperPaneRef]}else{const m=n(K,{value:e.value,onUpdateValue:b=>{e.value=b}});k(m,a),e.els=[a]}e.row=l,e.colProp=t}function o(){if(!e.els)return;e.row[e.colProp]=e.value;const l=e.els[0];k(null,l),l.style.padding="8px 0";const d=l.firstElementChild;d.style.display="block",d.classList.add("el-tooltip"),e.els=null,e.row="",e.colProp="",e.value=""}function B(){const l=e.row.province;if(!l){e.row.city="";return}const d=e.row.city,{citys:a}=i.find(t=>t.province===l);a.includes(d)||(e.row.city="")}function w(){_(),r.value.push({date:"",name:"",province:"",city:"",address:"",zip:""}),G(()=>{const l=p.value.layout.table.refs.tableBody;p.value.setScrollTop(l.clientHeight);const d=l.querySelectorAll("tbody tr.el-table__row"),t=d[d.length-1].children[1];t.style.padding=0;const u=t.firstElementChild;u.style.display="none",u.classList.remove("el-tooltip"),e.value="",e.row=r.value[r.value.length-1],e.colProp="date";const E=n(z,{value:e.value,autofocus:!1,onUpdateValue:g=>{e.value=g}});k(E,t),e.els=[t,E.component.exposed.popperEl.value]})}function _(l){!e.els||e.els.some(a=>a.contains(l.target))||(e.colProp==="province"&&B(),o())}return S(()=>{document.addEventListener("click",_)}),T(()=>{document.removeEventListener("click",_)}),(l,d)=>{const a=x("el-button"),t=x("el-row"),u=x("el-table-column"),E=x("el-table");return V(),N("div",null,[Z,n(t,{justify:"end"},{default:h(()=>[n(a,{type:"primary",plain:"",onClick:H(w,["stop"])},{default:h(()=>[O("新增")]),_:1},8,["onClick"])]),_:1}),n(E,{ref_key:"tableRef",ref:p,data:r.value,border:"",stripe:"","max-height":"500",onCellClick:s},{default:h(()=>[n(u,{type:"index",fixed:"",label:"序号",width:"80"}),n(u,{prop:"date",label:"日期","min-width":"120","show-overflow-tooltip":""}),n(u,{prop:"name",label:"名字","min-width":"120","show-overflow-tooltip":""}),n(u,{prop:"province",label:"省份","min-width":"120","show-overflow-tooltip":""}),n(u,{prop:"city",label:"城市","min-width":"120","show-overflow-tooltip":""}),n(u,{prop:"address",label:"地址","min-width":"180","show-overflow-tooltip":""}),n(u,{prop:"zip",label:"邮编","min-width":"120","show-overflow-tooltip":""})]),_:1},8,["data"])])}}};const te=J(ee,[["__scopeId","data-v-3804d4a1"]]);export{te as default};
