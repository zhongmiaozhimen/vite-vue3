import{_ as z,r as p,n as q,w as G,o as L,c as O,a as M,b as A,F as J,d as oe,e as ue,f as re,g as R,t as D,h as se,T as fe,i as de,j as K,k as y,l as o,m as h,p as Q,q as X}from"./index-208daab3.js";const ce={class:"virtual-list"},me={__name:"virtual-list",props:{data:{type:Array,default:()=>[]},height:{type:Number,default:void 0},maxHeight:{type:Number,default:void 0},minItemHeight:{type:Number,default:20},buffer:{type:Number,default:1},fixed:{type:Boolean,default:!0},showOverflowTooltip:{type:Boolean,default:!1}},setup(f){const e=f;let d=P(),i=d.length;const _=p(e.height?null:e.maxHeight);let v=0,b=0,l=0;const n=p([]);let u=0,c=0;const H=p(0),x=p(0);let a=0;const k=p(null),E=p(null);let C=[],F=!1;const U=p(null),T=p(!1),S=p(null);let s=null,I=null;te();function P(){return e.data.map((t,r)=>({id:`${Date.now()}-${r}`,data:t}))}function W(){n.value=d,H.value=0,x.value=0,a=0}function Z(){if(!e.height&&!e.maxHeight)return;let t=0;return e.fixed?e.height?t=Math.ceil(e.height/v):t=Math.ceil(e.maxHeight/v):e.height?t=Math.ceil(e.height/e.minItemHeight):t=Math.ceil(e.maxHeight/e.minItemHeight),t}function ee(){const t=E.value.children,r=[];for(let m=0;m<t.length;m++)r.push(t[m].getBoundingClientRect().height);for(let m=r.length;m<d.length;m++)r.push(e.minItemHeight);return r}function te(){if(i<=2||!e.height&&!e.maxHeight||!e.fixed&&!e.minItemHeight){W();return}if(e.fixed){n.value=d.slice(0,1),q(()=>{v=E.value.children[0].clientHeight,j()});return}j()}function j(){if(b=Z(),l=e.buffer*2||1,b+l>=i){W();return}const t=b+l;u=0,c=t-1,H.value=0,e.fixed?x.value=(i-t)*v:x.value=(i-t)*e.minItemHeight,n.value=d.slice(u,c+1),a=0,e.fixed||q(()=>{C=ee()})}function le(t){let r=0;if(e.fixed)r=Math.floor(t/v);else{let w=0;for(let V=0;V<C.length;V++){if(w+=C[V],t===w){r=V+1;break}if(t<w){r=V;break}}}if(t>a){if(a=t,c+1-r-b>e.buffer)return}else if(t<a){if(a=t,r-u>e.buffer)return}else return;l%2?u=r-Math.floor(l/2):u=r-l/2;const m=i-n.value.length;u<0?u=0:u>m&&(u=m),c=u+n.value.length-1;const N=i-1;if(c>N&&(c=N),n.value=d.slice(u,c+1),e.fixed)H.value=u*v,x.value=(i-c-1)*v;else{let w=0;for(let g=0;g<u;g++)w+=C[g];H.value=w;let V=0;for(let g=c+1;g<i;g++)V+=C[g];x.value=V,q(()=>{const g=E.value.children,$=[];for(let B=0;B<g.length;B++)$.push(g[B].getBoundingClientRect().height);C.splice(u,$.length,...$)})}}G(()=>e.data,()=>{if(k.value&&(k.value.scrollTop=0),d=P(),i=d.length,i<=2||!e.height&&!e.maxHeight||!e.fixed&&!e.minItemHeight){W();return}j()}),G([()=>e.height,()=>e.maxHeight],()=>{if(i<=2||!e.height&&!e.maxHeight||!e.fixed&&!e.minItemHeight){W();return}_.value=e.height?null:e.maxHeight,j()});function ne(t){s=null,e.showOverflowTooltip&&T.value&&(clearTimeout(I),I=null,S.value=null,T.value=!1),!(i<=2||!e.height&&!e.maxHeight||n.value.length>=i||!e.fixed&&!e.minItemHeight)&&(F||(F=!0,requestAnimationFrame(()=>{F=!1}),le(t.target.scrollTop)))}function ie(t){if(!e.showOverflowTooltip||t.target===t.currentTarget||s&&(s.contains(t.fromElement)||!s.contains(t.target)))return;if(s=t.target,t.target.parentElement!==t.currentTarget){const $=t.currentTarget.children;for(let B=0;B<$.length;B++)if($[B].contains(t.target)){s=$[B];break}}if(T.value&&S.value&&s&&S.value===s){clearTimeout(I),I=null,U.value.updateOpacity(1);return}const r=document.createRange();r.setStart(s,0),r.setEnd(s,s.childNodes.length);const m=r.getBoundingClientRect().width,N=window.getComputedStyle(s),w=parseInt(N.getPropertyValue("padding-left"))+parseInt(N.getPropertyValue("padding-right")),g=s.getBoundingClientRect().width;m+w-g>.02&&(clearTimeout(I),I=null,S.value=s,T.value=!0)}function ae(t){!e.showOverflowTooltip||s&&(!s.contains(t.target)||s.contains(t.toElement))||(s=null,!(!T.value||I)&&(U.value.updateOpacity(0),I=setTimeout(()=>{I=null,S.value=null,T.value=!1},200)))}return(t,r)=>(L(),O("div",ce,[M("div",{ref_key:"listWrapRef",ref:k,class:"list-wrap",style:A({height:f.height?f.height+"px":"","max-height":_.value?_.value+"px":""}),onScroll:ne},[M("ul",{ref_key:"listRef",ref:E,style:A({"padding-top":H.value+"px","padding-bottom":x.value+"px"}),onMouseover:ie,onMouseout:ae},[(L(!0),O(J,null,oe(n.value,m=>(L(),O("li",{key:m.id,class:ue(["list-item",{"is-tooltip":e.showOverflowTooltip}]),style:A({"white-space":f.fixed?"nowrap":"normal","word-break":f.fixed?"normal":"break-all",overflow:f.fixed?"hidden":"visible"})},[re(t.$slots,"default",{items:m.data},()=>[R(D(m),1)],!0)],6))),128))],36)],36),e.showOverflowTooltip&&T.value?(L(),se(fe,{key:0,ref_key:"tooltipRef",ref:U,"reference-el":S.value,enterable:!1,"teleport-to-body":!1,"scroll-top":k.value.scrollTop},null,8,["reference-el","scroll-top"])):de("",!0)]))}},Y=z(me,[["__scopeId","data-v-5e4917a6"]]);const he=f=>(Q("data-v-d6f06da0"),f=f(),X(),f),pe={class:"wrap"},ge=he(()=>M("span",null,"1222342353453",-1)),_e=500,ve={__name:"fixed-virtual-list",setup(f){const e=K({total:1e3,buffer:0}),d=p([]),i=p(0);_();function _(){d.value=[];for(let l=1;l<=e.total;l++)d.value.push({msg:`${l} --- ${v()}`});i.value=e.buffer}function v(){const l=["abcdefg","hijklmn","opq","rst","uvw","xyz","1","2","3","4"],n=Math.ceil(Math.random()*10);return l.slice(0,n).join("")}function b(l){e[l]!==""&&typeof e[l]=="string"&&(e[l]=e[l].replace(/[^0-9]/g,"").replace(/^0+(?=\d)/,""),e[l]=Number(e[l]))}return(l,n)=>{const u=y("el-input"),c=y("el-form-item"),H=y("el-button"),x=y("el-form");return L(),O("div",null,[o(x,{inline:""},{default:h(()=>[o(c,{label:"列表总数"},{default:h(()=>[o(u,{modelValue:e.total,"onUpdate:modelValue":n[0]||(n[0]=a=>e.total=a),modelModifiers:{number:!0},placeholder:"请输入列表总数",maxlength:"6",onBlur:n[1]||(n[1]=a=>b("total"))},null,8,["modelValue"])]),_:1}),o(c,{label:"缓冲量"},{default:h(()=>[o(u,{modelValue:e.buffer,"onUpdate:modelValue":n[2]||(n[2]=a=>e.buffer=a),modelModifiers:{number:!0},placeholder:"请输入滚动时的缓冲量",maxlength:"5",onBlur:n[3]||(n[3]=a=>b("buffer"))},null,8,["modelValue"])]),_:1}),o(c,null,{default:h(()=>[o(H,{type:"primary",onClick:_},{default:h(()=>[R("更新列表")]),_:1})]),_:1})]),_:1}),M("div",pe,[o(Y,{data:d.value,"max-height":_e,buffer:i.value,"show-overflow-tooltip":""},{default:h(({items:a})=>[ge,R(),M("span",null,D(a.msg),1)]),_:1},8,["data","buffer"])])])}}},be=z(ve,[["__scopeId","data-v-d6f06da0"]]);const xe={class:"wrap"},we=500,ye={__name:"dynamic-virtual-list",setup(f){const e=K({total:1e3,buffer:0}),d=p([]),i=p(0);_();function _(){d.value=[];for(let l=1;l<=e.total;l++)d.value.push({msg:`${l} --- ${v()}`});i.value=e.buffer}function v(){const l=["道可道也，非恒道也。","名可名也，非恒名也。","无名万物之始也，有名万物之母也。","故：恒无欲也，以观其眇；","恒有欲也，以观其徼。","两者同出，异名同谓。玄之又玄，众妙之门。","天下皆知美之为美，恶矣，皆知善之为善，斯不善矣。","有无之相生也，难易之相成也，长短之相形也，高下之相盈也，音声之相和也，先后之相随也。","是以圣人居无为之事，行不言之教。","万物作而弗始也，为而弗恃也，成功而弗居也，夫唯弗居，是以弗去。"],n=Math.ceil(Math.random()*10);return l.slice(0,n).join("")}function b(l){typeof e[l]=="string"&&(e[l]=e[l].replace(/[^0-9]/g,"").replace(/^0+(?=\d)/,""),e[l]=Number(e[l]))}return(l,n)=>{const u=y("el-input"),c=y("el-form-item"),H=y("el-button"),x=y("el-form");return L(),O("div",null,[o(x,{inline:""},{default:h(()=>[o(c,{label:"列表总数"},{default:h(()=>[o(u,{modelValue:e.total,"onUpdate:modelValue":n[0]||(n[0]=a=>e.total=a),modelModifiers:{number:!0},placeholder:"请输入列表总数",maxlength:"6",onBlur:n[1]||(n[1]=a=>b("total"))},null,8,["modelValue"])]),_:1}),o(c,{label:"缓冲量"},{default:h(()=>[o(u,{modelValue:e.buffer,"onUpdate:modelValue":n[2]||(n[2]=a=>e.buffer=a),placeholder:"请输入滚动时的缓冲量",maxlength:"5",onBlur:n[3]||(n[3]=a=>b("buffer"))},null,8,["modelValue"])]),_:1}),o(c,null,{default:h(()=>[o(H,{type:"primary",onClick:_},{default:h(()=>[R("更新列表")]),_:1})]),_:1})]),_:1}),M("div",xe,[o(Y,{data:d.value,"max-height":we,buffer:i.value,fixed:!1},{default:h(({items:a})=>[R(D(a.msg),1)]),_:1},8,["data","buffer"])])])}}},He=z(ye,[["__scopeId","data-v-9e44ceea"]]);const Ie=f=>(Q("data-v-111c59da"),f=f(),X(),f),Ve=Ie(()=>M("div",{class:"title"},"虚拟列表",-1)),Be={__name:"index",setup(f){return(e,d)=>{const i=y("el-tab-pane"),_=y("el-tabs");return L(),O(J,null,[Ve,o(_,{modelValue:"1"},{default:h(()=>[o(i,{label:"定高",name:"1"},{default:h(()=>[o(be)]),_:1}),o(i,{label:"非定高",name:"2",lazy:""},{default:h(()=>[o(He)]),_:1})]),_:1})],64)}}},$e=z(Be,[["__scopeId","data-v-111c59da"]]);export{$e as default};
