import{r as f,x as P,o as V,h as R,y,E as D,m as h,l as n,z as I,A as z,B as U,c as $,d as M,F as q,C as Y,D as A,G as T,k as x,H as k,p as W,q as F,a as H,I as O,g as j,n as G,_ as J}from"./index-f883fe85.js";const K={__name:"cell-input",props:{value:{type:String,default:""},autofocus:{type:Boolean,default:!0}},emits:["updateValue"],setup(d){const i=d,u=f(null),p=f(i.value);function v(){u.value.focus()}return P(()=>{i.autofocus&&v()}),(e,r)=>(V(),R(y(D),{ref_key:"inputRef",ref:u,modelValue:p.value,"onUpdate:modelValue":[r[0]||(r[0]=o=>p.value=o),r[1]||(r[1]=o=>e.$emit("updateValue",o))],placeholder:"请输入"},null,8,["modelValue"]))}},L={__name:"cell-date",props:{value:{type:String,default:""},autofocus:{type:Boolean,default:!0}},emits:["updateValue"],setup(d,{expose:i}){const u=d,p=f(null),v=f(u.value),e=f(null),r=`date-prper-${Date.now()}`;function o(){p.value.focus()}return P(()=>{u.autofocus&&o(),e.value=document.querySelector(`.${r}`)}),i({popperEl:e}),(S,b)=>(V(),R(y(U),{locale:y(z)},{default:h(()=>[n(y(I),{ref_key:"dateRef",ref:p,modelValue:v.value,"onUpdate:modelValue":[b[0]||(b[0]=_=>v.value=_),b[1]||(b[1]=_=>S.$emit("updateValue",_))],type:"date","value-format":"YYYY-MM-DD",placeholder:"选择日期","popper-class":r},null,8,["modelValue"])]),_:1},8,["locale"]))}},Q={__name:"cell-select",props:{value:{type:String,default:""},options:{type:Array,default:()=>[]},autofocus:{type:Boolean,default:!0}},emits:["updateValue"],setup(d){const i=d,u=f(null),p=f(i.value);function v(){u.value.toggleMenu()}return P(()=>{i.autofocus&&v()}),(e,r)=>(V(),R(y(U),{locale:y(z)},{default:h(()=>[n(y(Y),{ref_key:"selectRef",ref:u,modelValue:p.value,"onUpdate:modelValue":[r[0]||(r[0]=o=>p.value=o),r[1]||(r[1]=o=>e.$emit("updateValue",o))],placeholder:"请选择",clearable:"",filterable:""},{default:h(()=>[(V(!0),$(q,null,M(d.options,o=>(V(),R(y(A),{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["locale"]))}},X=d=>(W("data-v-918d175b"),d=d(),F(),d),Z=X(()=>H("div",{class:"title"},"表格编辑",-1)),ee={__name:"index",setup(d){const i=f(null),u=f([{date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000"},{date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000"},{date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000"},{date:"2016-05-03",name:"张三",province:"黑龙江",city:"哈尔滨",address:"南岗区-哈尔滨大街501号",zip:"000000"}]),p=[{province:"黑龙江",citys:["哈尔滨","齐齐哈尔","鸡西","鹤岗"]},{province:"吉林",citys:["长春","通化","白山","四平"]},{province:"辽宁",citys:["辽阳","大连","鞍山","抚顺"]}],v=["date","name","province","city","address","zip"];let e={row:"",colProp:"",els:null,value:""};function r(l,s,a){var B;const t=s.property;if(!v.includes(t)||(B=e.els)!=null&&B[0].contains(a))return;o(),a.style.padding=0;const c=a.firstElementChild;c.style.display="none",c.classList.remove("el-tooltip");const g=i.value.layout.table.refs.tableWrapper.querySelector(".el-popper");if(g&&(g.style.display="none"),e.value=l[t],t==="date"){const m=n(L,{value:e.value,onUpdateValue:w=>{e.value=w}});k(m,a),e.els=[a,m.component.exposed.popperEl.value]}else if(t==="province"||t==="city"){let m=[];if(t==="province")m=p.map(C=>C.province);else if(t==="city"&&l.province){const{citys:C}=p.find(N=>N.province===l.province);m=C}const w=n(Q,{value:e.value,options:m,onUpdateValue:C=>{e.value=C}});k(w,a),e.els=[a,w.component.refs.selectRef.popperPaneRef]}else{const m=n(K,{value:e.value,onUpdateValue:w=>{e.value=w}});k(m,a),e.els=[a]}e.row=l,e.colProp=t}function o(){if(!e.els)return;const l=e.els[0],s=l.firstElementChild;e.row[e.colProp]!==e.value&&e.value&&(s.classList.remove("error"),s.classList.add("success")),e.value||(s.classList.remove("success"),s.classList.add("error")),e.row[e.colProp]=e.value,k(null,l),l.style.padding="8px 0",s.style.display="block",s.classList.add("el-tooltip"),e.els=null,e.row="",e.colProp="",e.value=""}function S(){const l=e.row.province;if(!l){e.row.city="";return}const s=e.row.city,{citys:a}=p.find(t=>t.province===l);a.includes(s)||(e.row.city="")}function b(){_(),u.value.push({date:"",name:"",province:"",city:"",address:"",zip:""}),G(()=>{const l=i.value.layout.table.refs.tableBody;i.value.setScrollTop(l.clientHeight);const s=l.querySelectorAll("tbody tr.el-table__row"),t=s[s.length-1].children[1];t.style.padding=0;const c=t.firstElementChild;c.style.display="none",c.classList.remove("el-tooltip"),e.value="",e.row=u.value[u.value.length-1],e.colProp="date";const E=n(L,{value:e.value,autofocus:!1,onUpdateValue:g=>{e.value=g}});k(E,t),e.els=[t,E.component.exposed.popperEl.value]})}function _(l){!e.els||e.els.some(a=>a.contains(l.target))||(e.colProp==="province"&&S(),o())}return P(()=>{document.addEventListener("click",_)}),T(()=>{document.removeEventListener("click",_)}),(l,s)=>{const a=x("el-button"),t=x("el-row"),c=x("el-table-column"),E=x("el-table");return V(),$("div",null,[Z,n(t,{justify:"end"},{default:h(()=>[n(a,{type:"primary",plain:"",onClick:O(b,["stop"])},{default:h(()=>[j("新增")]),_:1},8,["onClick"])]),_:1}),n(E,{ref_key:"tableRef",ref:i,data:u.value,border:"",stripe:"","max-height":"500",onCellClick:r},{default:h(()=>[n(c,{type:"index",fixed:"",label:"序号",width:"80"}),n(c,{prop:"date",label:"日期","min-width":"120","show-overflow-tooltip":""}),n(c,{prop:"name",label:"名字","min-width":"120","show-overflow-tooltip":""}),n(c,{prop:"province",label:"省份","min-width":"120","show-overflow-tooltip":""}),n(c,{prop:"city",label:"城市","min-width":"120","show-overflow-tooltip":""}),n(c,{prop:"address",label:"地址","min-width":"180","show-overflow-tooltip":""}),n(c,{prop:"zip",label:"邮编","min-width":"120","show-overflow-tooltip":""})]),_:1},8,["data"])])}}};const te=J(ee,[["__scopeId","data-v-918d175b"]]);export{te as default};
