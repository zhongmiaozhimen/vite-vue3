import{_ as C,r as V,n as q,o as Z,w as ee,a as L,c as M,b as T,F as G,d as te,e as w,u as B,f as le,g as J,h as x,i as s,j as _,k as K,t as O,p as ie,l as ae}from"./index-73416700.js";const ne={__name:"virtual-list",props:{data:{type:Array,default:()=>[]},height:{type:Number,default:void 0},maxHeight:{type:Number,default:void 0},itemHeight:{type:Number,default:10},minItemHeight:{type:Number,default:10},invisible:{type:Number,default:10},fixed:{type:Boolean,default:!0}},setup(v){const e=v,r=e.fixed;let m=[],i=0,d=0,p=e.itemHeight?e.itemHeight:10,H=e.minItemHeight?e.minItemHeight:10,l=0,t=0;const u=Math.ceil(t/4),n=V([]);let f=0,h=0,a=0;const S=V(0),I=V(0);let $=0;const R=V(null),F=V(null);let y=[],U=!1;Q();function Q(){e.height&&e.maxHeight?d=Math.min(e.height,e.maxHeight):e.height?d=e.height:e.maxHeight&&(d=e.maxHeight),D()}function D(){if(R.value&&(R.value.scrollTop=0),m=e.data.map((g,o)=>({id:`${new Date().getTime()}-${o}`,data:g})),i=m.length,p=e.itemHeight?e.itemHeight:10,H=e.minItemHeight?e.minItemHeight:10,!d){n.value=m;return}r?l=Math.ceil(d/p):l=Math.ceil(d/H),l>i&&(l=i),t=e.invisible>=10?e.invisible:10,l+t>i&&(t=i-l),f=l+t,h=0,a=f-1,S.value=0,r?I.value=(i-f)*p:I.value=(i-f)*H,n.value=m.slice(h,a+1),$=0,r||q(()=>{y=z()})}function z(){const g=F.value.children,o=[];for(let c=0;c<g.length;c++)o.push(g[c].getBoundingClientRect().height);for(let c=o.length;c<m.length;c++)o.push(H);return o}Z(()=>{if(r||!d||f>=i)return;y=z();let g=0;for(let o=0;o<y.length;o++){if(g+=y[o],d===g){l=o+1;break}if(d<g){l=o+1;break}}l===0&&(l=i),l+t>i&&(t=i-l),f=l+t,a=f-1,n.value=m.slice(h,a+1),I.value=(i-f)*H}),ee(()=>e.data,()=>{D()});function X(g){const o=g.target.scrollTop;let c=0;if(r)c=Math.floor(o/p);else{let N=0;for(let k=0;k<y.length;k++){if(N+=y[k],o===N){c=k+1;break}if(o<N){c=k;break}}}if(o>$){if($=o,a+1-c-l>u)return}else if(o<$){if($=o,c-h>u)return}else return;h=c-Math.floor(t/2);const A=i-f;h<0?h=0:h>A&&(h=A),a=h+f-1;const E=i-1;if(a>E&&(a=E),n.value=m.slice(h,a+1),r)S.value=h*p,I.value=(i-a-1)*p;else{let N=0;for(let b=0;b<h;b++)N+=y[b];S.value=N;let k=0;for(let b=a+1;b<i;b++)k+=y[b];I.value=k,q(()=>{const b=F.value.children,W=[];for(let j=0;j<b.length;j++)W.push(b[j].getBoundingClientRect().height);y.splice(h,W.length,...W)})}}function Y(g){!d||f>=i||U||(U=!0,requestAnimationFrame(()=>{U=!1}),X(g))}return(g,o)=>(L(),M("div",{ref_key:"listWrapRef",ref:R,class:"list-wrap",style:w({height:v.height?v.height+"px":"","max-height":v.maxHeight?v.maxHeight+"px":""}),onScroll:Y},[T("ul",{ref_key:"listRef",ref:F,style:w({"padding-top":S.value+"px","padding-bottom":I.value+"px"})},[(L(!0),M(G,null,te(n.value,c=>(L(),M("li",{key:c.id,class:"list-item",style:w({height:B(r)?B(p)+"px":"","word-break":B(r)?"normal":"break-all",overflow:B(r)?"hidden":"visible"})},[le(g.$slots,"default",{item:c.data},void 0,!0)],4))),128))],4)],36))}},P=C(ne,[["__scopeId","data-v-411dc473"]]);const oe={class:"wrap"},se={__name:"fixed-virtual-list",setup(v){const e=J({total:1e3,height:30}),r=V([]),m=V(e.height);let i=e.total,d=e.height;p();function p(){let l=Number(e.total);l||(e.total=i,l=i),i=l,r.value=[];for(let u=1;u<=l;u++)r.value.push({msg:`${H()} --- ${u}`});let t=Number(e.height);t||(e.height=d,t=d),d=t,m.value=t}function H(){let l="";const t=["a","b","c","d","e","f","g","h","i","j","k"];for(let u=0;u<t.length;u++){const n=Math.ceil(Math.random()*10);l+=t[n]}return l}return(l,t)=>{const u=x("el-input"),n=x("el-form-item"),f=x("el-button"),h=x("el-form");return L(),M("div",null,[s(h,{inline:""},{default:_(()=>[s(n,{label:"列表总数"},{default:_(()=>[s(u,{modelValue:e.total,"onUpdate:modelValue":t[0]||(t[0]=a=>e.total=a),modelModifiers:{number:!0},placeholder:"请输入列表总数"},null,8,["modelValue"])]),_:1}),s(n,{label:"行高"},{default:_(()=>[s(u,{modelValue:e.height,"onUpdate:modelValue":t[1]||(t[1]=a=>e.height=a),placeholder:"请输入每一行的高度"},null,8,["modelValue"])]),_:1}),s(n,null,{default:_(()=>[s(f,{type:"primary",onClick:p},{default:_(()=>[K("加载列表")]),_:1})]),_:1})]),_:1}),T("div",oe,[s(P,{data:r.value,"max-height":300,"item-height":m.value,invisible:20},{default:_(({item:a})=>[T("div",{class:"list-item",style:w({"line-height":m.value-1+"px"})},O(a.msg),5)]),_:1},8,["data","item-height"])])])}}},ue=C(se,[["__scopeId","data-v-a58279d6"]]);const re={class:"wrap"},de={__name:"dynamic-virtual-list",setup(v){const e=J({total:1e3,minHeight:30}),r=V([]),m=V(e.minHeight);let i=e.total,d=e.minHeight;p();function p(){let l=Number(e.total);l||(e.total=i,l=i),i=l,r.value=[];let t=0;for(let n=1;n<=l;n++)t=Math.ceil(Math.random()*200),t=t<30?30:t,r.value.push({msg:`${H()} --- ${n}`,height:t});Number(e.minHeight)||(e.minHeight=d,t=d),d=t,m.value=t}function H(){let l="";const t=["a","b","c","d","e","f","g","h","i","j","k"];for(let u=0;u<t.length;u++){const n=Math.ceil(Math.random()*10);l+=t[n]}return l}return(l,t)=>{const u=x("el-input"),n=x("el-form-item"),f=x("el-button"),h=x("el-form");return L(),M("div",null,[s(h,{inline:""},{default:_(()=>[s(n,{label:"列表总数"},{default:_(()=>[s(u,{modelValue:e.total,"onUpdate:modelValue":t[0]||(t[0]=a=>e.total=a),modelModifiers:{number:!0},placeholder:"请输入列表总数"},null,8,["modelValue"])]),_:1}),s(n,{label:"最小行高"},{default:_(()=>[s(u,{modelValue:e.minHeight,"onUpdate:modelValue":t[1]||(t[1]=a=>e.minHeight=a),placeholder:"请输入行高的最小值"},null,8,["modelValue"])]),_:1}),s(n,null,{default:_(()=>[s(f,{type:"primary",onClick:p},{default:_(()=>[K("加载列表")]),_:1})]),_:1})]),_:1}),T("div",re,[s(P,{data:r.value,"max-height":300,"min-item-height":m.value,invisible:20,fixed:!1},{default:_(({item:a})=>[T("div",{class:"list-item",style:w({height:a.height+"px","line-height":a.height+"px"})},O(a.msg),5)]),_:1},8,["data","min-item-height"])])])}}},he=C(de,[["__scopeId","data-v-b20793dd"]]);const me=v=>(ie("data-v-111c59da"),v=v(),ae(),v),ce=me(()=>T("div",{class:"title"},"虚拟列表",-1)),fe={__name:"index",setup(v){return(e,r)=>{const m=x("el-tab-pane"),i=x("el-tabs");return L(),M(G,null,[ce,s(i,{modelValue:"1"},{default:_(()=>[s(m,{label:"定高",name:"1"},{default:_(()=>[s(ue)]),_:1}),s(m,{label:"非定高",name:"2",lazy:""},{default:_(()=>[s(he)]),_:1})]),_:1})],64)}}},ge=C(fe,[["__scopeId","data-v-111c59da"]]);export{ge as default};
