import{_ as W,r as p,n as q,w as P,o as B,c as L,a as C,b as A,F as G,d as ne,e as ie,f as oe,g as S,t as D,h as ae,T as ue,i as re,j as J,k as y,l as u,m as c,p as se,q as fe}from"./index-f883fe85.js";const de={class:"virtual-list"},ce={__name:"virtual-list",props:{data:{type:Array,default:()=>[]},height:{type:Number,default:void 0},maxHeight:{type:Number,default:void 0},minItemHeight:{type:Number,default:20},buffer:{type:Number,default:1},fixed:{type:Boolean,default:!0},showOverflowTooltip:{type:Boolean,default:!1}},setup(m){const e=m;let s=j(),i=s.length;const h=p(e.height?null:e.maxHeight);let g=0,b=0,l=0;const n=p([]);let r=0,f=0;const H=p(0),x=p(0);let o=0;const O=p(null),N=p(null);let T=[],z=!1;const F=p(null),I=p(!1),$=p(null);let V=null;Y();function j(){return e.data.map((t,a)=>({id:`${Date.now()}-${a}`,data:t}))}function R(){n.value=s,H.value=0,x.value=0,o=0}function Q(){if(!e.height&&!e.maxHeight)return;let t=0;return e.fixed?e.height?t=Math.ceil(e.height/g):t=Math.ceil(e.maxHeight/g):e.height?t=Math.ceil(e.height/e.minItemHeight):t=Math.ceil(e.maxHeight/e.minItemHeight),t}function X(){const t=N.value.children,a=[];for(let d=0;d<t.length;d++)a.push(t[d].getBoundingClientRect().height);for(let d=a.length;d<s.length;d++)a.push(e.minItemHeight);return a}function Y(){if(i<=2||!e.height&&!e.maxHeight||!e.fixed&&!e.minItemHeight){R();return}if(e.fixed){n.value=s.slice(0,1),q(()=>{g=N.value.children[0].clientHeight,k()});return}k()}function k(){if(b=Q(),l=e.buffer*2||1,b+l>=i){R();return}const t=b+l;r=0,f=t-1,H.value=0,e.fixed?x.value=(i-t)*g:x.value=(i-t)*e.minItemHeight,n.value=s.slice(r,f+1),o=0,e.fixed||q(()=>{T=X()})}function Z(t){let a=0;if(e.fixed)a=Math.floor(t/g);else{let _=0;for(let w=0;w<T.length;w++){if(_+=T[w],t===_){a=w+1;break}if(t<_){a=w;break}}}if(t>o){if(o=t,f+1-a-b>e.buffer)return}else if(t<o){if(o=t,a-r>e.buffer)return}else return;l%2?r=a-Math.floor(l/2):r=a-l/2;const d=i-n.value.length;r<0?r=0:r>d&&(r=d),f=r+n.value.length-1;const E=i-1;if(f>E&&(f=E),n.value=s.slice(r,f+1),e.fixed)H.value=r*g,x.value=(i-f-1)*g;else{let _=0;for(let v=0;v<r;v++)_+=T[v];H.value=_;let w=0;for(let v=f+1;v<i;v++)w+=T[v];x.value=w,q(()=>{const v=N.value.children,M=[];for(let U=0;U<v.length;U++)M.push(v[U].getBoundingClientRect().height);T.splice(r,M.length,...M)})}}P(()=>e.data,()=>{if(O.value&&(O.value.scrollTop=0),s=j(),i=s.length,i<=2||!e.height&&!e.maxHeight||!e.fixed&&!e.minItemHeight){R();return}k()}),P([()=>e.height,()=>e.maxHeight],()=>{if(i<=2||!e.height&&!e.maxHeight||!e.fixed&&!e.minItemHeight){R();return}h.value=e.height?null:e.maxHeight,k()});function ee(t){e.showOverflowTooltip&&I.value&&(clearTimeout(V),V=null,$.value=null,I.value=!1),!(i<=2||!e.height&&!e.maxHeight||n.value.length>=i||!e.fixed&&!e.minItemHeight)&&(z||(z=!0,requestAnimationFrame(()=>{z=!1}),Z(t.target.scrollTop)))}function te(t){if(!e.showOverflowTooltip||t.target===t.currentTarget||t.target.parentElement!==t.currentTarget)return;if(I.value&&$.value&&$.value===t.target){clearTimeout(V),V=null,F.value.updateOpacity(1);return}const a=t.target,d=document.createRange();d.setStart(a,0),d.setEnd(a,a.childNodes.length);const E=d.getBoundingClientRect().width,_=window.getComputedStyle(a),w=parseInt(_.getPropertyValue("padding-left"))+parseInt(_.getPropertyValue("padding-right")),M=a.getBoundingClientRect().width;E+w-M>.02&&(clearTimeout(V),V=null,$.value=a,I.value=!0)}function le(){!e.showOverflowTooltip||!I.value||V||(F.value.updateOpacity(0),V=setTimeout(()=>{V=null,$.value=null,I.value=!1},200))}return(t,a)=>(B(),L("div",de,[C("div",{ref_key:"listWrapRef",ref:O,class:"list-wrap",style:A({height:m.height?m.height+"px":"","max-height":h.value?h.value+"px":""}),onScroll:ee},[C("ul",{ref_key:"listRef",ref:N,style:A({"padding-top":H.value+"px","padding-bottom":x.value+"px"}),onMouseover:te,onMouseout:le},[(B(!0),L(G,null,ne(n.value,d=>(B(),L("li",{key:d.id,class:ie(["list-item",{"is-tooltip":e.showOverflowTooltip}]),style:A({"white-space":m.fixed?"nowrap":"normal","word-break":m.fixed?"normal":"break-all",overflow:m.fixed?"hidden":"visible"})},[oe(t.$slots,"default",{items:d.data},()=>[S(D(d),1)],!0)],6))),128))],36)],36),e.showOverflowTooltip&&I.value?(B(),ae(ue,{key:0,ref_key:"tooltipRef",ref:F,"reference-el":$.value,enterable:!1,"teleport-to-body":!1,"scroll-top":O.value.scrollTop},null,8,["reference-el","scroll-top"])):re("",!0)]))}},K=W(ce,[["__scopeId","data-v-4adf2705"]]);const me={class:"wrap"},pe=500,he={__name:"fixed-virtual-list",setup(m){const e=J({total:1e3,buffer:0}),s=p([]),i=p(0);h();function h(){s.value=[];for(let l=1;l<=e.total;l++)s.value.push({msg:`${l} --- ${g()}`});i.value=e.buffer}function g(){const l=["abcdefg","hijklmn","opq","rst","uvw","xyz","1","2","3","4"],n=Math.ceil(Math.random()*10);return l.slice(0,n)}function b(l){e[l]!==""&&typeof e[l]=="string"&&(e[l]=e[l].replace(/[^0-9]/g,"").replace(/^0+(?=\d)/,""),e[l]=Number(e[l]))}return(l,n)=>{const r=y("el-input"),f=y("el-form-item"),H=y("el-button"),x=y("el-form");return B(),L("div",null,[u(x,{inline:""},{default:c(()=>[u(f,{label:"列表总数"},{default:c(()=>[u(r,{modelValue:e.total,"onUpdate:modelValue":n[0]||(n[0]=o=>e.total=o),modelModifiers:{number:!0},placeholder:"请输入列表总数",maxlength:"6",onBlur:n[1]||(n[1]=o=>b("total"))},null,8,["modelValue"])]),_:1}),u(f,{label:"缓冲量"},{default:c(()=>[u(r,{modelValue:e.buffer,"onUpdate:modelValue":n[2]||(n[2]=o=>e.buffer=o),modelModifiers:{number:!0},placeholder:"请输入滚动时的缓冲量",maxlength:"5",onBlur:n[3]||(n[3]=o=>b("buffer"))},null,8,["modelValue"])]),_:1}),u(f,null,{default:c(()=>[u(H,{type:"primary",onClick:h},{default:c(()=>[S("更新列表")]),_:1})]),_:1})]),_:1}),C("div",me,[u(K,{data:s.value,"max-height":pe,buffer:i.value,"show-overflow-tooltip":""},{default:c(({items:o})=>[S(D(o.msg),1)]),_:1},8,["data","buffer"])])])}}},ge=W(he,[["__scopeId","data-v-5c084a5d"]]);const _e={class:"wrap"},ve=500,be={__name:"dynamic-virtual-list",setup(m){const e=J({total:1e3,buffer:0}),s=p([]),i=p(0);h();function h(){s.value=[];for(let l=1;l<=e.total;l++)s.value.push({msg:`${l} --- ${g()}`});i.value=e.buffer}function g(){const l=["道可道也，非恒道也。","名可名也，非恒名也。","无名万物之始也，有名万物之母也。","故：恒无欲也，以观其眇；","恒有欲也，以观其徼。","两者同出，异名同谓。玄之又玄，众妙之门。","天下皆知美之为美，恶矣，皆知善之为善，斯不善矣。","有无之相生也，难易之相成也，长短之相形也，高下之相盈也，音声之相和也，先后之相随也。","是以圣人居无为之事，行不言之教。","万物作而弗始也，为而弗恃也，成功而弗居也，夫唯弗居，是以弗去。"],n=Math.ceil(Math.random()*10);return l.slice(0,n)}function b(l){typeof e[l]=="string"&&(e[l]=e[l].replace(/[^0-9]/g,"").replace(/^0+(?=\d)/,""),e[l]=Number(e[l]))}return(l,n)=>{const r=y("el-input"),f=y("el-form-item"),H=y("el-button"),x=y("el-form");return B(),L("div",null,[u(x,{inline:""},{default:c(()=>[u(f,{label:"列表总数"},{default:c(()=>[u(r,{modelValue:e.total,"onUpdate:modelValue":n[0]||(n[0]=o=>e.total=o),modelModifiers:{number:!0},placeholder:"请输入列表总数",maxlength:"6",onBlur:n[1]||(n[1]=o=>b("total"))},null,8,["modelValue"])]),_:1}),u(f,{label:"缓冲量"},{default:c(()=>[u(r,{modelValue:e.buffer,"onUpdate:modelValue":n[2]||(n[2]=o=>e.buffer=o),placeholder:"请输入滚动时的缓冲量",maxlength:"5",onBlur:n[3]||(n[3]=o=>b("buffer"))},null,8,["modelValue"])]),_:1}),u(f,null,{default:c(()=>[u(H,{type:"primary",onClick:h},{default:c(()=>[S("更新列表")]),_:1})]),_:1})]),_:1}),C("div",_e,[u(K,{data:s.value,"max-height":ve,buffer:i.value,fixed:!1},{default:c(({items:o})=>[S(D(o.msg),1)]),_:1},8,["data","buffer"])])])}}},xe=W(be,[["__scopeId","data-v-6bd7bc3f"]]);const we=m=>(se("data-v-111c59da"),m=m(),fe(),m),ye=we(()=>C("div",{class:"title"},"虚拟列表",-1)),He={__name:"index",setup(m){return(e,s)=>{const i=y("el-tab-pane"),h=y("el-tabs");return B(),L(G,null,[ye,u(h,{modelValue:"1"},{default:c(()=>[u(i,{label:"定高",name:"1"},{default:c(()=>[u(ge)]),_:1}),u(i,{label:"非定高",name:"2",lazy:""},{default:c(()=>[u(xe)]),_:1})]),_:1})],64)}}},Ie=W(He,[["__scopeId","data-v-111c59da"]]);export{Ie as default};
