import{_ as k,r as g,n as j,w as q,o as I,c as $,a as L,b as z,F as A,d as ee,e as te,f as le,g as M,t as F,h as ie,T as ne,i as ae,j as D,k as H,l as o,m,p as oe,q as ue}from"./index-50b49a0b.js";const re={class:"virtual-list"},se={__name:"virtual-list",props:{data:{type:Array,default:()=>[]},height:{type:Number,default:void 0},maxHeight:{type:Number,default:void 0},minItemHeight:{type:Number,default:20},buffer:{type:Number,default:1},fixed:{type:Boolean,default:!0},showOverflowTooltip:{type:Boolean,default:!1}},setup(c){const e=c;let f=U(),n=f.length;const h=g(e.height?null:e.maxHeight);let p=0,v=0,l=0;const i=g([]);let u=0,d=0;const w=g(0),b=g(0);let a=0;const S=g(null),T=g(null);let B=[],O=!1;const _=g(null);P();function U(){return e.data.map((t,r)=>({id:`${Date.now()}-${r}`,data:t}))}function C(){i.value=f,w.value=0,b.value=0,a=0}function J(){if(!e.height&&!e.maxHeight)return;let t=0;return e.fixed?e.height?t=Math.ceil(e.height/p):t=Math.ceil(e.maxHeight/p):e.height?t=Math.ceil(e.height/e.minItemHeight):t=Math.ceil(e.maxHeight/e.minItemHeight),t}function K(){const t=T.value.children,r=[];for(let s=0;s<t.length;s++)r.push(t[s].getBoundingClientRect().height);for(let s=r.length;s<f.length;s++)r.push(e.minItemHeight);return r}function P(){if(n<=2||!e.height&&!e.maxHeight||!e.fixed&&!e.minItemHeight){C();return}if(e.fixed){i.value=f.slice(0,1),j(()=>{p=T.value.children[0].clientHeight,N()});return}N()}function N(){if(v=J(),l=e.buffer*2||1,v+l>=n){C();return}const t=v+l;u=0,d=t-1,w.value=0,e.fixed?b.value=(n-t)*p:b.value=(n-t)*e.minItemHeight,i.value=f.slice(u,d+1),a=0,e.fixed||j(()=>{B=K()})}function Q(t){let r=0;if(e.fixed)r=Math.floor(t/p);else{let y=0;for(let V=0;V<B.length;V++){if(y+=B[V],t===y){r=V+1;break}if(t<y){r=V;break}}}if(t>a){if(a=t,d+1-r-v>e.buffer)return}else if(t<a){if(a=t,r-u>e.buffer)return}else return;l%2?u=r-Math.floor(l/2):u=r-l/2;const s=n-i.value.length;u<0?u=0:u>s&&(u=s),d=u+i.value.length-1;const W=n-1;if(d>W&&(d=W),i.value=f.slice(u,d+1),e.fixed)w.value=u*p,b.value=(n-d-1)*p;else{let y=0;for(let x=0;x<u;x++)y+=B[x];w.value=y;let V=0;for(let x=d+1;x<n;x++)V+=B[x];b.value=V,j(()=>{const x=T.value.children,E=[];for(let R=0;R<x.length;R++)E.push(x[R].getBoundingClientRect().height);B.splice(u,E.length,...E)})}}q(()=>e.data,()=>{if(S.value&&(S.value.scrollTop=0),f=U(),n=f.length,n<=2||!e.height&&!e.maxHeight||!e.fixed&&!e.minItemHeight){C();return}N()}),q([()=>e.height,()=>e.maxHeight],()=>{if(n<=2||!e.height&&!e.maxHeight||!e.fixed&&!e.minItemHeight){C();return}h.value=e.height?null:e.maxHeight,N()});function X(t){e.showOverflowTooltip&&(_.value=null),!(n<=2||!e.height&&!e.maxHeight||i.value.length>=n||!e.fixed&&!e.minItemHeight)&&(O||(O=!0,requestAnimationFrame(()=>{O=!1}),Q(t.target.scrollTop)))}function Y(t){if(!(!e.showOverflowTooltip||t.target===t.currentTarget||_.value&&(_.value.contains(t.fromElement)||!_.value.contains(t.target)))&&(_.value=t.target,t.target.parentElement!==t.currentTarget)){const r=t.currentTarget.children;for(let s=0;s<r.length;s++)if(r[s].contains(t.target)){_.value=r[s];break}}}function Z(t){!e.showOverflowTooltip||_.value&&(!_.value.contains(t.target)||_.value.contains(t.toElement))||(_.value=null)}return(t,r)=>(I(),$("div",re,[L("div",{ref_key:"listWrapRef",ref:S,class:"list-wrap",style:z({height:c.height?c.height+"px":"","max-height":h.value?h.value+"px":""}),onScroll:X},[L("ul",{ref_key:"listRef",ref:T,style:z({"padding-top":w.value+"px","padding-bottom":b.value+"px"}),onMouseover:Y,onMouseout:Z},[(I(!0),$(A,null,ee(i.value,s=>(I(),$("li",{key:s.id,class:te(["list-item",{tooltip:e.showOverflowTooltip}]),style:z({"white-space":c.fixed?"nowrap":"normal","word-break":c.fixed?"normal":"break-all",overflow:c.fixed?"hidden":"visible"})},[le(t.$slots,"default",{items:s.data},()=>[M(F(s),1)],!0)],6))),128))],36)],36),e.showOverflowTooltip?(I(),ie(ne,{key:0,"mouseenter-el":_.value,enterable:!1,"teleport-to-body":!1},null,8,["mouseenter-el"])):ae("",!0)]))}},G=k(se,[["__scopeId","data-v-80e77499"]]);const fe={class:"wrap"},de=500,me={__name:"fixed-virtual-list",setup(c){const e=D({total:1e3,buffer:0}),f=g([]),n=g(0);h();function h(){f.value=[];for(let l=1;l<=e.total;l++)f.value.push({msg:`${l} --- ${p()}`});n.value=e.buffer}function p(){const l=["abcdefg","hijklmn","opq","rst","uvw","xyz","1","2","3","4"],i=Math.ceil(Math.random()*10);return l.slice(0,i).join("")}function v(l){e[l]!==""&&typeof e[l]=="string"&&(e[l]=e[l].replace(/[^0-9]/g,"").replace(/^0+(?=\d)/,""),e[l]=Number(e[l]))}return(l,i)=>{const u=H("el-input"),d=H("el-form-item"),w=H("el-button"),b=H("el-form");return I(),$("div",null,[o(b,{inline:""},{default:m(()=>[o(d,{label:"列表总数"},{default:m(()=>[o(u,{modelValue:e.total,"onUpdate:modelValue":i[0]||(i[0]=a=>e.total=a),modelModifiers:{number:!0},placeholder:"请输入列表总数",maxlength:"6",onBlur:i[1]||(i[1]=a=>v("total"))},null,8,["modelValue"])]),_:1}),o(d,{label:"缓冲量"},{default:m(()=>[o(u,{modelValue:e.buffer,"onUpdate:modelValue":i[2]||(i[2]=a=>e.buffer=a),modelModifiers:{number:!0},placeholder:"请输入滚动时的缓冲量",maxlength:"5",onBlur:i[3]||(i[3]=a=>v("buffer"))},null,8,["modelValue"])]),_:1}),o(d,null,{default:m(()=>[o(w,{type:"primary",onClick:h},{default:m(()=>[M("更新列表")]),_:1})]),_:1})]),_:1}),L("div",fe,[o(G,{data:f.value,"max-height":de,buffer:n.value,"show-overflow-tooltip":""},{default:m(({items:a})=>[M(F(a.msg)+"345555555555555555555555555555555555555555555555555555 ",1)]),_:1},8,["data","buffer"])])])}}},ce=k(me,[["__scopeId","data-v-1ef5323f"]]);const he={class:"wrap"},pe=500,_e={__name:"dynamic-virtual-list",setup(c){const e=D({total:1e3,buffer:0}),f=g([]),n=g(0);h();function h(){f.value=[];for(let l=1;l<=e.total;l++)f.value.push({msg:`${l} --- ${p()}`});n.value=e.buffer}function p(){const l=["道可道也，非恒道也。","名可名也，非恒名也。","无名万物之始也，有名万物之母也。","故：恒无欲也，以观其眇；","恒有欲也，以观其徼。","两者同出，异名同谓。玄之又玄，众妙之门。","天下皆知美之为美，恶矣，皆知善之为善，斯不善矣。","有无之相生也，难易之相成也，长短之相形也，高下之相盈也，音声之相和也，先后之相随也。","是以圣人居无为之事，行不言之教。","万物作而弗始也，为而弗恃也，成功而弗居也，夫唯弗居，是以弗去。"],i=Math.ceil(Math.random()*10);return l.slice(0,i).join("")}function v(l){typeof e[l]=="string"&&(e[l]=e[l].replace(/[^0-9]/g,"").replace(/^0+(?=\d)/,""),e[l]=Number(e[l]))}return(l,i)=>{const u=H("el-input"),d=H("el-form-item"),w=H("el-button"),b=H("el-form");return I(),$("div",null,[o(b,{inline:""},{default:m(()=>[o(d,{label:"列表总数"},{default:m(()=>[o(u,{modelValue:e.total,"onUpdate:modelValue":i[0]||(i[0]=a=>e.total=a),modelModifiers:{number:!0},placeholder:"请输入列表总数",maxlength:"6",onBlur:i[1]||(i[1]=a=>v("total"))},null,8,["modelValue"])]),_:1}),o(d,{label:"缓冲量"},{default:m(()=>[o(u,{modelValue:e.buffer,"onUpdate:modelValue":i[2]||(i[2]=a=>e.buffer=a),placeholder:"请输入滚动时的缓冲量",maxlength:"5",onBlur:i[3]||(i[3]=a=>v("buffer"))},null,8,["modelValue"])]),_:1}),o(d,null,{default:m(()=>[o(w,{type:"primary",onClick:h},{default:m(()=>[M("更新列表")]),_:1})]),_:1})]),_:1}),L("div",he,[o(G,{data:f.value,"max-height":pe,buffer:n.value,fixed:!1},{default:m(({items:a})=>[M(F(a.msg),1)]),_:1},8,["data","buffer"])])])}}},ge=k(_e,[["__scopeId","data-v-9e44ceea"]]);const ve=c=>(oe("data-v-42faf1d4"),c=c(),ue(),c),be=ve(()=>L("div",{class:"title"},"虚拟列表",-1)),xe={__name:"index",setup(c){return(e,f)=>{const n=H("el-tab-pane"),h=H("el-tabs");return I(),$(A,null,[be,o(h,{"model-value":"1"},{default:m(()=>[o(n,{label:"定高",name:"1"},{default:m(()=>[o(ce)]),_:1}),o(n,{label:"非定高",name:"2",lazy:""},{default:m(()=>[o(ge)]),_:1})]),_:1})],64)}}},we=k(xe,[["__scopeId","data-v-42faf1d4"]]);export{we as default};
