import{_ as k,r as x,a as A,n as U,w as z,o as B,c as $,b as w,F as E,d as ee,e as M,f as te,t as D,g as le,h as b,i as u,j as d,k as q,p as ie,l as ne}from"./index-ac776286.js";const ae={__name:"virtual-list",props:{data:{type:Array,default:()=>[]},height:{type:Number,default:void 0},maxHeight:{type:Number,default:void 0},minItemHeight:{type:Number,default:20},buffer:{type:Number,default:1},fixed:{type:Boolean,default:!0},showOverflowTooltip:{type:Boolean,default:!1}},setup(m){const e=m;let s=O(),a=s.length;const h=x(e.height?null:e.maxHeight);let p=0,_=0,t=0;const l=x([]);let n=0,r=0;const y=x(0),g=x(0);let o=0;const T=x(null),C=x(null);let L=[],R=!1;const I=A({content:null,maxWidth:0,maxHeight:0,left:0,top:0,opacity:0,arrowStyle:null});P();function O(){return e.data.map((i,f)=>({id:`${new Date().getTime()}-${f}`,data:i}))}function S(){l.value=s,y.value=0,g.value=0,o=0}function J(){if(!e.height&&!e.maxHeight)return;let i=0;return e.fixed?e.height?i=Math.ceil(e.height/p):i=Math.ceil(e.maxHeight/p):e.height?i=Math.ceil(e.height/e.minItemHeight):i=Math.ceil(e.maxHeight/e.minItemHeight),i}function K(){const i=C.value.children,f=[];for(let c=0;c<i.length;c++)f.push(i[c].getBoundingClientRect().height);for(let c=f.length;c<s.length;c++)f.push(e.minItemHeight);return f}function P(){if(a<=2||!e.height&&!e.maxHeight||!e.fixed&&!e.minItemHeight){S();return}if(e.fixed){l.value=s.slice(0,1),U(()=>{p=C.value.children[0].clientHeight,N()});return}N()}function N(){if(_=J(),t=e.buffer*2||1,_+t>=a){S();return}const i=_+t;n=0,r=i-1,y.value=0,e.fixed?g.value=(a-i)*p:g.value=(a-i)*e.minItemHeight,l.value=s.slice(n,r+1),o=0,e.fixed||U(()=>{L=K()})}function Q(i){let f=0;if(e.fixed)f=Math.floor(i/p);else{let H=0;for(let V=0;V<L.length;V++){if(H+=L[V],i===H){f=V+1;break}if(i<H){f=V;break}}}if(i>o){if(o=i,r+1-f-_>e.buffer)return}else if(i<o){if(o=i,f-n>e.buffer)return}else return;t%2?n=f-Math.floor(t/2):n=f-t/2;const c=a-l.value.length;n<0?n=0:n>c&&(n=c),r=n+l.value.length-1;const j=a-1;if(r>j&&(r=j),l.value=s.slice(n,r+1),e.fixed)y.value=n*p,g.value=(a-r-1)*p;else{let H=0;for(let v=0;v<n;v++)H+=L[v];y.value=H;let V=0;for(let v=r+1;v<a;v++)V+=L[v];g.value=V,U(()=>{const v=C.value.children,W=[];for(let F=0;F<v.length;F++)W.push(v[F].getBoundingClientRect().height);L.splice(n,W.length,...W)})}}z(()=>e.data,()=>{if(T.value&&(T.value.scrollTop=0),s=O(),a=s.length,a<=2||!e.height&&!e.maxHeight||!e.fixed&&!e.minItemHeight){S();return}N()}),z([()=>e.height,()=>e.maxHeight],()=>{if(a<=2||!e.height&&!e.maxHeight||!e.fixed&&!e.minItemHeight){S();return}h.value=e.height?null:e.maxHeight,N()});function X(i){a<=2||!e.height&&!e.maxHeight||l.value.length>=a||!e.fixed&&!e.minItemHeight||R||(R=!0,requestAnimationFrame(()=>{R=!1}),Q(i.target.scrollTop))}function Y(){}function Z(){}return(i,f)=>(B(),$("div",{ref_key:"listWrapRef",ref:T,class:"list-wrap",style:M({height:m.height?m.height+"px":"","max-height":h.value?h.value+"px":""}),onScroll:X},[w("ul",{ref_key:"listRef",ref:C,style:M({"padding-top":y.value+"px","padding-bottom":g.value+"px"}),onMouseenter:Y,onMouseleave:Z},[(B(!0),$(E,null,ee(l.value,c=>(B(),$("li",{key:c.id,class:"list-item",style:M({"word-break":m.fixed?"normal":"break-all",overflow:m.fixed?"hidden":"visible"})},[te(i.$slots,"default",{item:c.data},void 0,!0)],4))),128))],36),m.showOverflowTooltip?(B(),$("div",{key:0,class:"tooltip",style:M({left:I.left+"px",top:I.top+"px",opacity:I.opacity})},[w("div",{class:"tooltip-content",style:M({"max-width":I.maxWidth+"px","max-height":I.maxHeight+"px"})},D(I.content),5),w("div",{class:"tooltip-arrow",style:M(I.arrowStyle)},null,4)],4)):le("",!0)],36))}},G=k(ae,[["__scopeId","data-v-4d4fa367"]]);const oe={class:"wrap"},ue={class:"list-item"},re=500,se={__name:"fixed-virtual-list",setup(m){const e=A({total:1e3,buffer:0}),s=x([]),a=x(0);h();function h(){s.value=[];for(let t=1;t<=e.total;t++)s.value.push({msg:`${p()} --- ${t}`});a.value=e.buffer}function p(){let t="";const l=["a","b","c","d","e","f","g","h","i","j","k"];for(let n=0;n<l.length;n++){const r=Math.ceil(Math.random()*10);t+=l[r]}return t}function _(t){e[t]!==""&&typeof e[t]=="string"&&(e[t]=e[t].replace(/[^0-9]/g,"").replace(/^0+(?=\d)/,""),e[t]=Number(e[t]))}return(t,l)=>{const n=b("el-input"),r=b("el-form-item"),y=b("el-button"),g=b("el-form");return B(),$("div",null,[u(g,{inline:""},{default:d(()=>[u(r,{label:"列表总数"},{default:d(()=>[u(n,{modelValue:e.total,"onUpdate:modelValue":l[0]||(l[0]=o=>e.total=o),modelModifiers:{number:!0},placeholder:"请输入列表总数",maxlength:"6",onBlur:l[1]||(l[1]=o=>_("total"))},null,8,["modelValue"])]),_:1}),u(r,{label:"缓冲量"},{default:d(()=>[u(n,{modelValue:e.buffer,"onUpdate:modelValue":l[2]||(l[2]=o=>e.buffer=o),modelModifiers:{number:!0},placeholder:"请输入滚动时的缓冲量",maxlength:"5",onBlur:l[3]||(l[3]=o=>_("buffer"))},null,8,["modelValue"])]),_:1}),u(r,null,{default:d(()=>[u(y,{type:"primary",onClick:h},{default:d(()=>[q("更新列表")]),_:1})]),_:1})]),_:1}),w("div",oe,[u(G,{data:s.value,"max-height":re,buffer:a.value},{default:d(({item:o})=>[w("div",ue,D(o.msg),1)]),_:1},8,["data","buffer"])])])}}},fe=k(se,[["__scopeId","data-v-45c9a0a0"]]);const de={class:"wrap"},me={class:"list-item"},ce=500,he={__name:"dynamic-virtual-list",setup(m){const e=A({total:1e3,buffer:0}),s=x([]),a=x(0);h();function h(){s.value=[];for(let t=1;t<=e.total;t++)s.value.push({msg:`${p()} --- ${t}`});a.value=e.buffer}function p(){const t=["道可道也，非恒道也。","名可名也，非恒名也。","无名万物之始也，有名万物之母也。","故：恒无欲也，以观其眇；","恒有欲也，以观其徼。","两者同出，异名同谓。玄之又玄，众妙之门。","天下皆知美之为美，恶矣，皆知善之为善，斯不善矣。","有无之相生也，难易之相成也，长短之相形也，高下之相盈也，音声之相和也，先后之相随也。","是以圣人居无为之事，行不言之教。","万物作而弗始也，为而弗恃也，成功而弗居也，夫唯弗居，是以弗去。"],l=Math.ceil(Math.random()*10);return t.slice(0,l)}function _(t){typeof e[t]=="string"&&(e[t]=e[t].replace(/[^0-9]/g,"").replace(/^0+(?=\d)/,""),e[t]=Number(e[t]))}return(t,l)=>{const n=b("el-input"),r=b("el-form-item"),y=b("el-button"),g=b("el-form");return B(),$("div",null,[u(g,{inline:""},{default:d(()=>[u(r,{label:"列表总数"},{default:d(()=>[u(n,{modelValue:e.total,"onUpdate:modelValue":l[0]||(l[0]=o=>e.total=o),modelModifiers:{number:!0},placeholder:"请输入列表总数",maxlength:"6",onBlur:l[1]||(l[1]=o=>_("total"))},null,8,["modelValue"])]),_:1}),u(r,{label:"缓冲量"},{default:d(()=>[u(n,{modelValue:e.buffer,"onUpdate:modelValue":l[2]||(l[2]=o=>e.buffer=o),placeholder:"请输入滚动时的缓冲量",maxlength:"5",onBlur:l[3]||(l[3]=o=>_("buffer"))},null,8,["modelValue"])]),_:1}),u(r,null,{default:d(()=>[u(y,{type:"primary",onClick:h},{default:d(()=>[q("更新列表")]),_:1})]),_:1})]),_:1}),w("div",de,[u(G,{data:s.value,"max-height":ce,buffer:a.value,fixed:!1},{default:d(({item:o})=>[w("div",me,D(o.msg),1)]),_:1},8,["data","buffer"])])])}}},pe=k(he,[["__scopeId","data-v-d5395962"]]);const _e=m=>(ie("data-v-111c59da"),m=m(),ne(),m),ge=_e(()=>w("div",{class:"title"},"虚拟列表",-1)),ve={__name:"index",setup(m){return(e,s)=>{const a=b("el-tab-pane"),h=b("el-tabs");return B(),$(E,null,[ge,u(h,{modelValue:"1"},{default:d(()=>[u(a,{label:"定高",name:"1"},{default:d(()=>[u(fe)]),_:1}),u(a,{label:"非定高",name:"2",lazy:""},{default:d(()=>[u(pe)]),_:1})]),_:1})],64)}}},be=k(ve,[["__scopeId","data-v-111c59da"]]);export{be as default};
